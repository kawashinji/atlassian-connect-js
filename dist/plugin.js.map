{"version":3,"sources":["node_modules/browserify/node_modules/browser-pack/_prelude.js","src/plugin/index.js","node_modules/base-64/base64.js","node_modules/jsuri/Uri.js","node_modules/utf8/utf8.js","src/common/base64.js","src/common/dollar.js","src/common/dom-events.js","src/common/events.js","src/common/jwt.js","src/common/ui-params.js","src/common/uri.js","src/common/xdm-rpc.js","src/host/util.js","src/plugin/amd.js","src/plugin/dialog.js","src/plugin/dollar.js","src/plugin/env.js","src/plugin/events.js","src/plugin/inline-dialog.js","src/plugin/messages.js","src/plugin/propagate.js","src/plugin/resize_listener.js","src/plugin/rpc.js","src/plugin/util.js"],"names":[],"mappings":"AAAA;;;;;;;;;;;mBCEgB,OAAO;;;;oBACN,QAAQ;;;;sBACX,UAAU;;;;4BACJ,kBAAkB;;;;4BAClB,kBAAkB;;;;yBACtB,eAAe;;;;8BACV,qBAAqB;;;;yBAC1B,eAAe;;;;4BACZ,mBAAmB;;;;mBACtB,OAAO;;;;uBACJ,UAAU;;;;mBACb,OAAO;;;;sBACJ,UAAU;;;;4BACJ,iBAAiB;;;;wBACrB,YAAY;;;;2BACV,gBAAgB;;;;AAjBvC,IAAI,EAAE,GAAG,MAAM,CAAC,EAAE,GAAG,EAAE,CAAC;;;;;AAsBxB,oBAAE,MAAM,CAAC,EAAE,sCAAY;AACnB,OAAG,EAAE,EAAC,MAAM,EAAE,iBAAI,MAAM,EAAE,IAAI,EAAE,iBAAI,IAAI,EAAC;AACzC,QAAI,EAAE,EAAC,GAAG,EAAE,iBAAI,IAAI,EAAC;;AAErB,UAAM,qBAAQ;CACjB,CAAC,CAAC;;AAEH,MAAM,CAAC,EAAE,GAAG,EAAE,CAAC;qBACA,EAAE;;;;AC9BjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5cA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAC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","file":"plugin.js","sourceRoot":"/source/","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","var AP = window.AP = {};\n//INSERT AMD STUBBER HERE!\nimport amd from './amd';\nimport util from './util';\nimport $ from './dollar';\nimport _events from '../common/events';\nimport base64 from  '../common/base64';\nimport uri from '../common/uri';\nimport uiParams from '../common/ui-params';\nimport jwt from '../common/jwt';\nimport xdmRpc from '../common/xdm-rpc';\nimport rpc from './rpc';\nimport events from './events';\nimport env from './env';\nimport dialog from './dialog';\nimport inlineDialog from './inline-dialog';\nimport messages from './messages';\nimport propagator from './propagate.js';\n\n// import cookie from './cookie';\n// import request from './request';\n\n$.extend(AP, env, amd, {\n    rpc: {extend: rpc.extend, init: rpc.init},\n    Meta: {get: env.meta},\n//    request: request,\n    Dialog: dialog,\n});\n\nwindow.AP = AP;\nexport default AP\n","(function (global){\n/*! http://mths.be/base64 v0.1.0 by @mathias | MIT license */\n;(function(root) {\n\n\t// Detect free variables `exports`.\n\tvar freeExports = typeof exports == 'object' && exports;\n\n\t// Detect free variable `module`.\n\tvar freeModule = typeof module == 'object' && module &&\n\t\tmodule.exports == freeExports && module;\n\n\t// Detect free variable `global`, from Node.js or Browserified code, and use\n\t// it as `root`.\n\tvar freeGlobal = typeof global == 'object' && global;\n\tif (freeGlobal.global === freeGlobal || freeGlobal.window === freeGlobal) {\n\t\troot = freeGlobal;\n\t}\n\n\t/*--------------------------------------------------------------------------*/\n\n\tvar InvalidCharacterError = function(message) {\n\t\tthis.message = message;\n\t};\n\tInvalidCharacterError.prototype = new Error;\n\tInvalidCharacterError.prototype.name = 'InvalidCharacterError';\n\n\tvar error = function(message) {\n\t\t// Note: the error messages used throughout this file match those used by\n\t\t// the native `atob`/`btoa` implementation in Chromium.\n\t\tthrow new InvalidCharacterError(message);\n\t};\n\n\tvar TABLE = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n\t// http://whatwg.org/html/common-microsyntaxes.html#space-character\n\tvar REGEX_SPACE_CHARACTERS = /[\\t\\n\\f\\r ]/g;\n\n\t// `decode` is designed to be fully compatible with `atob` as described in the\n\t// HTML Standard. http://whatwg.org/html/webappapis.html#dom-windowbase64-atob\n\t// The optimized base64-decoding algorithm used is based on @atk’s excellent\n\t// implementation. https://gist.github.com/atk/1020396\n\tvar decode = function(input) {\n\t\tinput = String(input)\n\t\t\t.replace(REGEX_SPACE_CHARACTERS, '');\n\t\tvar length = input.length;\n\t\tif (length % 4 == 0) {\n\t\t\tinput = input.replace(/==?$/, '');\n\t\t\tlength = input.length;\n\t\t}\n\t\tif (\n\t\t\tlength % 4 == 1 ||\n\t\t\t// http://whatwg.org/C#alphanumeric-ascii-characters\n\t\t\t/[^+a-zA-Z0-9/]/.test(input)\n\t\t) {\n\t\t\terror(\n\t\t\t\t'Invalid character: the string to be decoded is not correctly encoded.'\n\t\t\t);\n\t\t}\n\t\tvar bitCounter = 0;\n\t\tvar bitStorage;\n\t\tvar buffer;\n\t\tvar output = '';\n\t\tvar position = -1;\n\t\twhile (++position < length) {\n\t\t\tbuffer = TABLE.indexOf(input.charAt(position));\n\t\t\tbitStorage = bitCounter % 4 ? bitStorage * 64 + buffer : buffer;\n\t\t\t// Unless this is the first of a group of 4 characters…\n\t\t\tif (bitCounter++ % 4) {\n\t\t\t\t// …convert the first 8 bits to a single ASCII character.\n\t\t\t\toutput += String.fromCharCode(\n\t\t\t\t\t0xFF & bitStorage >> (-2 * bitCounter & 6)\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\treturn output;\n\t};\n\n\t// `encode` is designed to be fully compatible with `btoa` as described in the\n\t// HTML Standard: http://whatwg.org/html/webappapis.html#dom-windowbase64-btoa\n\tvar encode = function(input) {\n\t\tinput = String(input);\n\t\tif (/[^\\0-\\xFF]/.test(input)) {\n\t\t\t// Note: no need to special-case astral symbols here, as surrogates are\n\t\t\t// matched, and the input is supposed to only contain ASCII anyway.\n\t\t\terror(\n\t\t\t\t'The string to be encoded contains characters outside of the ' +\n\t\t\t\t'Latin1 range.'\n\t\t\t);\n\t\t}\n\t\tvar padding = input.length % 3;\n\t\tvar output = '';\n\t\tvar position = -1;\n\t\tvar a;\n\t\tvar b;\n\t\tvar c;\n\t\tvar d;\n\t\tvar buffer;\n\t\t// Make sure any padding is handled outside of the loop.\n\t\tvar length = input.length - padding;\n\n\t\twhile (++position < length) {\n\t\t\t// Read three bytes, i.e. 24 bits.\n\t\t\ta = input.charCodeAt(position) << 16;\n\t\t\tb = input.charCodeAt(++position) << 8;\n\t\t\tc = input.charCodeAt(++position);\n\t\t\tbuffer = a + b + c;\n\t\t\t// Turn the 24 bits into four chunks of 6 bits each, and append the\n\t\t\t// matching character for each of them to the output.\n\t\t\toutput += (\n\t\t\t\tTABLE.charAt(buffer >> 18 & 0x3F) +\n\t\t\t\tTABLE.charAt(buffer >> 12 & 0x3F) +\n\t\t\t\tTABLE.charAt(buffer >> 6 & 0x3F) +\n\t\t\t\tTABLE.charAt(buffer & 0x3F)\n\t\t\t);\n\t\t}\n\n\t\tif (padding == 2) {\n\t\t\ta = input.charCodeAt(position) << 8;\n\t\t\tb = input.charCodeAt(++position);\n\t\t\tbuffer = a + b;\n\t\t\toutput += (\n\t\t\t\tTABLE.charAt(buffer >> 10) +\n\t\t\t\tTABLE.charAt((buffer >> 4) & 0x3F) +\n\t\t\t\tTABLE.charAt((buffer << 2) & 0x3F) +\n\t\t\t\t'='\n\t\t\t);\n\t\t} else if (padding == 1) {\n\t\t\tbuffer = input.charCodeAt(position);\n\t\t\toutput += (\n\t\t\t\tTABLE.charAt(buffer >> 2) +\n\t\t\t\tTABLE.charAt((buffer << 4) & 0x3F) +\n\t\t\t\t'=='\n\t\t\t);\n\t\t}\n\n\t\treturn output;\n\t};\n\n\tvar base64 = {\n\t\t'encode': encode,\n\t\t'decode': decode,\n\t\t'version': '0.1.0'\n\t};\n\n\t// Some AMD build optimizers, like r.js, check for specific condition patterns\n\t// like the following:\n\tif (\n\t\ttypeof define == 'function' &&\n\t\ttypeof define.amd == 'object' &&\n\t\tdefine.amd\n\t) {\n\t\tdefine(function() {\n\t\t\treturn base64;\n\t\t});\n\t}\telse if (freeExports && !freeExports.nodeType) {\n\t\tif (freeModule) { // in Node.js or RingoJS v0.8.0+\n\t\t\tfreeModule.exports = base64;\n\t\t} else { // in Narwhal or RingoJS v0.7.0-\n\t\t\tfor (var key in base64) {\n\t\t\t\tbase64.hasOwnProperty(key) && (freeExports[key] = base64[key]);\n\t\t\t}\n\t\t}\n\t} else { // in Rhino or a web browser\n\t\troot.base64 = base64;\n\t}\n\n}(this));\n\n}).call(this,typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9iYXNlLTY0L2Jhc2U2NC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIi8qISBodHRwOi8vbXRocy5iZS9iYXNlNjQgdjAuMS4wIGJ5IEBtYXRoaWFzIHwgTUlUIGxpY2Vuc2UgKi9cbjsoZnVuY3Rpb24ocm9vdCkge1xuXG5cdC8vIERldGVjdCBmcmVlIHZhcmlhYmxlcyBgZXhwb3J0c2AuXG5cdHZhciBmcmVlRXhwb3J0cyA9IHR5cGVvZiBleHBvcnRzID09ICdvYmplY3QnICYmIGV4cG9ydHM7XG5cblx0Ly8gRGV0ZWN0IGZyZWUgdmFyaWFibGUgYG1vZHVsZWAuXG5cdHZhciBmcmVlTW9kdWxlID0gdHlwZW9mIG1vZHVsZSA9PSAnb2JqZWN0JyAmJiBtb2R1bGUgJiZcblx0XHRtb2R1bGUuZXhwb3J0cyA9PSBmcmVlRXhwb3J0cyAmJiBtb2R1bGU7XG5cblx0Ly8gRGV0ZWN0IGZyZWUgdmFyaWFibGUgYGdsb2JhbGAsIGZyb20gTm9kZS5qcyBvciBCcm93c2VyaWZpZWQgY29kZSwgYW5kIHVzZVxuXHQvLyBpdCBhcyBgcm9vdGAuXG5cdHZhciBmcmVlR2xvYmFsID0gdHlwZW9mIGdsb2JhbCA9PSAnb2JqZWN0JyAmJiBnbG9iYWw7XG5cdGlmIChmcmVlR2xvYmFsLmdsb2JhbCA9PT0gZnJlZUdsb2JhbCB8fCBmcmVlR2xvYmFsLndpbmRvdyA9PT0gZnJlZUdsb2JhbCkge1xuXHRcdHJvb3QgPSBmcmVlR2xvYmFsO1xuXHR9XG5cblx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0dmFyIEludmFsaWRDaGFyYWN0ZXJFcnJvciA9IGZ1bmN0aW9uKG1lc3NhZ2UpIHtcblx0XHR0aGlzLm1lc3NhZ2UgPSBtZXNzYWdlO1xuXHR9O1xuXHRJbnZhbGlkQ2hhcmFjdGVyRXJyb3IucHJvdG90eXBlID0gbmV3IEVycm9yO1xuXHRJbnZhbGlkQ2hhcmFjdGVyRXJyb3IucHJvdG90eXBlLm5hbWUgPSAnSW52YWxpZENoYXJhY3RlckVycm9yJztcblxuXHR2YXIgZXJyb3IgPSBmdW5jdGlvbihtZXNzYWdlKSB7XG5cdFx0Ly8gTm90ZTogdGhlIGVycm9yIG1lc3NhZ2VzIHVzZWQgdGhyb3VnaG91dCB0aGlzIGZpbGUgbWF0Y2ggdGhvc2UgdXNlZCBieVxuXHRcdC8vIHRoZSBuYXRpdmUgYGF0b2JgL2BidG9hYCBpbXBsZW1lbnRhdGlvbiBpbiBDaHJvbWl1bS5cblx0XHR0aHJvdyBuZXcgSW52YWxpZENoYXJhY3RlckVycm9yKG1lc3NhZ2UpO1xuXHR9O1xuXG5cdHZhciBUQUJMRSA9ICdBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSsvJztcblx0Ly8gaHR0cDovL3doYXR3Zy5vcmcvaHRtbC9jb21tb24tbWljcm9zeW50YXhlcy5odG1sI3NwYWNlLWNoYXJhY3RlclxuXHR2YXIgUkVHRVhfU1BBQ0VfQ0hBUkFDVEVSUyA9IC9bXFx0XFxuXFxmXFxyIF0vZztcblxuXHQvLyBgZGVjb2RlYCBpcyBkZXNpZ25lZCB0byBiZSBmdWxseSBjb21wYXRpYmxlIHdpdGggYGF0b2JgIGFzIGRlc2NyaWJlZCBpbiB0aGVcblx0Ly8gSFRNTCBTdGFuZGFyZC4gaHR0cDovL3doYXR3Zy5vcmcvaHRtbC93ZWJhcHBhcGlzLmh0bWwjZG9tLXdpbmRvd2Jhc2U2NC1hdG9iXG5cdC8vIFRoZSBvcHRpbWl6ZWQgYmFzZTY0LWRlY29kaW5nIGFsZ29yaXRobSB1c2VkIGlzIGJhc2VkIG9uIEBhdGvigJlzIGV4Y2VsbGVudFxuXHQvLyBpbXBsZW1lbnRhdGlvbi4gaHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20vYXRrLzEwMjAzOTZcblx0dmFyIGRlY29kZSA9IGZ1bmN0aW9uKGlucHV0KSB7XG5cdFx0aW5wdXQgPSBTdHJpbmcoaW5wdXQpXG5cdFx0XHQucmVwbGFjZShSRUdFWF9TUEFDRV9DSEFSQUNURVJTLCAnJyk7XG5cdFx0dmFyIGxlbmd0aCA9IGlucHV0Lmxlbmd0aDtcblx0XHRpZiAobGVuZ3RoICUgNCA9PSAwKSB7XG5cdFx0XHRpbnB1dCA9IGlucHV0LnJlcGxhY2UoLz09PyQvLCAnJyk7XG5cdFx0XHRsZW5ndGggPSBpbnB1dC5sZW5ndGg7XG5cdFx0fVxuXHRcdGlmIChcblx0XHRcdGxlbmd0aCAlIDQgPT0gMSB8fFxuXHRcdFx0Ly8gaHR0cDovL3doYXR3Zy5vcmcvQyNhbHBoYW51bWVyaWMtYXNjaWktY2hhcmFjdGVyc1xuXHRcdFx0L1teK2EtekEtWjAtOS9dLy50ZXN0KGlucHV0KVxuXHRcdCkge1xuXHRcdFx0ZXJyb3IoXG5cdFx0XHRcdCdJbnZhbGlkIGNoYXJhY3RlcjogdGhlIHN0cmluZyB0byBiZSBkZWNvZGVkIGlzIG5vdCBjb3JyZWN0bHkgZW5jb2RlZC4nXG5cdFx0XHQpO1xuXHRcdH1cblx0XHR2YXIgYml0Q291bnRlciA9IDA7XG5cdFx0dmFyIGJpdFN0b3JhZ2U7XG5cdFx0dmFyIGJ1ZmZlcjtcblx0XHR2YXIgb3V0cHV0ID0gJyc7XG5cdFx0dmFyIHBvc2l0aW9uID0gLTE7XG5cdFx0d2hpbGUgKCsrcG9zaXRpb24gPCBsZW5ndGgpIHtcblx0XHRcdGJ1ZmZlciA9IFRBQkxFLmluZGV4T2YoaW5wdXQuY2hhckF0KHBvc2l0aW9uKSk7XG5cdFx0XHRiaXRTdG9yYWdlID0gYml0Q291bnRlciAlIDQgPyBiaXRTdG9yYWdlICogNjQgKyBidWZmZXIgOiBidWZmZXI7XG5cdFx0XHQvLyBVbmxlc3MgdGhpcyBpcyB0aGUgZmlyc3Qgb2YgYSBncm91cCBvZiA0IGNoYXJhY3RlcnPigKZcblx0XHRcdGlmIChiaXRDb3VudGVyKysgJSA0KSB7XG5cdFx0XHRcdC8vIOKApmNvbnZlcnQgdGhlIGZpcnN0IDggYml0cyB0byBhIHNpbmdsZSBBU0NJSSBjaGFyYWN0ZXIuXG5cdFx0XHRcdG91dHB1dCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKFxuXHRcdFx0XHRcdDB4RkYgJiBiaXRTdG9yYWdlID4+ICgtMiAqIGJpdENvdW50ZXIgJiA2KVxuXHRcdFx0XHQpO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gb3V0cHV0O1xuXHR9O1xuXG5cdC8vIGBlbmNvZGVgIGlzIGRlc2lnbmVkIHRvIGJlIGZ1bGx5IGNvbXBhdGlibGUgd2l0aCBgYnRvYWAgYXMgZGVzY3JpYmVkIGluIHRoZVxuXHQvLyBIVE1MIFN0YW5kYXJkOiBodHRwOi8vd2hhdHdnLm9yZy9odG1sL3dlYmFwcGFwaXMuaHRtbCNkb20td2luZG93YmFzZTY0LWJ0b2Fcblx0dmFyIGVuY29kZSA9IGZ1bmN0aW9uKGlucHV0KSB7XG5cdFx0aW5wdXQgPSBTdHJpbmcoaW5wdXQpO1xuXHRcdGlmICgvW15cXDAtXFx4RkZdLy50ZXN0KGlucHV0KSkge1xuXHRcdFx0Ly8gTm90ZTogbm8gbmVlZCB0byBzcGVjaWFsLWNhc2UgYXN0cmFsIHN5bWJvbHMgaGVyZSwgYXMgc3Vycm9nYXRlcyBhcmVcblx0XHRcdC8vIG1hdGNoZWQsIGFuZCB0aGUgaW5wdXQgaXMgc3VwcG9zZWQgdG8gb25seSBjb250YWluIEFTQ0lJIGFueXdheS5cblx0XHRcdGVycm9yKFxuXHRcdFx0XHQnVGhlIHN0cmluZyB0byBiZSBlbmNvZGVkIGNvbnRhaW5zIGNoYXJhY3RlcnMgb3V0c2lkZSBvZiB0aGUgJyArXG5cdFx0XHRcdCdMYXRpbjEgcmFuZ2UuJ1xuXHRcdFx0KTtcblx0XHR9XG5cdFx0dmFyIHBhZGRpbmcgPSBpbnB1dC5sZW5ndGggJSAzO1xuXHRcdHZhciBvdXRwdXQgPSAnJztcblx0XHR2YXIgcG9zaXRpb24gPSAtMTtcblx0XHR2YXIgYTtcblx0XHR2YXIgYjtcblx0XHR2YXIgYztcblx0XHR2YXIgZDtcblx0XHR2YXIgYnVmZmVyO1xuXHRcdC8vIE1ha2Ugc3VyZSBhbnkgcGFkZGluZyBpcyBoYW5kbGVkIG91dHNpZGUgb2YgdGhlIGxvb3AuXG5cdFx0dmFyIGxlbmd0aCA9IGlucHV0Lmxlbmd0aCAtIHBhZGRpbmc7XG5cblx0XHR3aGlsZSAoKytwb3NpdGlvbiA8IGxlbmd0aCkge1xuXHRcdFx0Ly8gUmVhZCB0aHJlZSBieXRlcywgaS5lLiAyNCBiaXRzLlxuXHRcdFx0YSA9IGlucHV0LmNoYXJDb2RlQXQocG9zaXRpb24pIDw8IDE2O1xuXHRcdFx0YiA9IGlucHV0LmNoYXJDb2RlQXQoKytwb3NpdGlvbikgPDwgODtcblx0XHRcdGMgPSBpbnB1dC5jaGFyQ29kZUF0KCsrcG9zaXRpb24pO1xuXHRcdFx0YnVmZmVyID0gYSArIGIgKyBjO1xuXHRcdFx0Ly8gVHVybiB0aGUgMjQgYml0cyBpbnRvIGZvdXIgY2h1bmtzIG9mIDYgYml0cyBlYWNoLCBhbmQgYXBwZW5kIHRoZVxuXHRcdFx0Ly8gbWF0Y2hpbmcgY2hhcmFjdGVyIGZvciBlYWNoIG9mIHRoZW0gdG8gdGhlIG91dHB1dC5cblx0XHRcdG91dHB1dCArPSAoXG5cdFx0XHRcdFRBQkxFLmNoYXJBdChidWZmZXIgPj4gMTggJiAweDNGKSArXG5cdFx0XHRcdFRBQkxFLmNoYXJBdChidWZmZXIgPj4gMTIgJiAweDNGKSArXG5cdFx0XHRcdFRBQkxFLmNoYXJBdChidWZmZXIgPj4gNiAmIDB4M0YpICtcblx0XHRcdFx0VEFCTEUuY2hhckF0KGJ1ZmZlciAmIDB4M0YpXG5cdFx0XHQpO1xuXHRcdH1cblxuXHRcdGlmIChwYWRkaW5nID09IDIpIHtcblx0XHRcdGEgPSBpbnB1dC5jaGFyQ29kZUF0KHBvc2l0aW9uKSA8PCA4O1xuXHRcdFx0YiA9IGlucHV0LmNoYXJDb2RlQXQoKytwb3NpdGlvbik7XG5cdFx0XHRidWZmZXIgPSBhICsgYjtcblx0XHRcdG91dHB1dCArPSAoXG5cdFx0XHRcdFRBQkxFLmNoYXJBdChidWZmZXIgPj4gMTApICtcblx0XHRcdFx0VEFCTEUuY2hhckF0KChidWZmZXIgPj4gNCkgJiAweDNGKSArXG5cdFx0XHRcdFRBQkxFLmNoYXJBdCgoYnVmZmVyIDw8IDIpICYgMHgzRikgK1xuXHRcdFx0XHQnPSdcblx0XHRcdCk7XG5cdFx0fSBlbHNlIGlmIChwYWRkaW5nID09IDEpIHtcblx0XHRcdGJ1ZmZlciA9IGlucHV0LmNoYXJDb2RlQXQocG9zaXRpb24pO1xuXHRcdFx0b3V0cHV0ICs9IChcblx0XHRcdFx0VEFCTEUuY2hhckF0KGJ1ZmZlciA+PiAyKSArXG5cdFx0XHRcdFRBQkxFLmNoYXJBdCgoYnVmZmVyIDw8IDQpICYgMHgzRikgK1xuXHRcdFx0XHQnPT0nXG5cdFx0XHQpO1xuXHRcdH1cblxuXHRcdHJldHVybiBvdXRwdXQ7XG5cdH07XG5cblx0dmFyIGJhc2U2NCA9IHtcblx0XHQnZW5jb2RlJzogZW5jb2RlLFxuXHRcdCdkZWNvZGUnOiBkZWNvZGUsXG5cdFx0J3ZlcnNpb24nOiAnMC4xLjAnXG5cdH07XG5cblx0Ly8gU29tZSBBTUQgYnVpbGQgb3B0aW1pemVycywgbGlrZSByLmpzLCBjaGVjayBmb3Igc3BlY2lmaWMgY29uZGl0aW9uIHBhdHRlcm5zXG5cdC8vIGxpa2UgdGhlIGZvbGxvd2luZzpcblx0aWYgKFxuXHRcdHR5cGVvZiBkZWZpbmUgPT0gJ2Z1bmN0aW9uJyAmJlxuXHRcdHR5cGVvZiBkZWZpbmUuYW1kID09ICdvYmplY3QnICYmXG5cdFx0ZGVmaW5lLmFtZFxuXHQpIHtcblx0XHRkZWZpbmUoZnVuY3Rpb24oKSB7XG5cdFx0XHRyZXR1cm4gYmFzZTY0O1xuXHRcdH0pO1xuXHR9XHRlbHNlIGlmIChmcmVlRXhwb3J0cyAmJiAhZnJlZUV4cG9ydHMubm9kZVR5cGUpIHtcblx0XHRpZiAoZnJlZU1vZHVsZSkgeyAvLyBpbiBOb2RlLmpzIG9yIFJpbmdvSlMgdjAuOC4wK1xuXHRcdFx0ZnJlZU1vZHVsZS5leHBvcnRzID0gYmFzZTY0O1xuXHRcdH0gZWxzZSB7IC8vIGluIE5hcndoYWwgb3IgUmluZ29KUyB2MC43LjAtXG5cdFx0XHRmb3IgKHZhciBrZXkgaW4gYmFzZTY0KSB7XG5cdFx0XHRcdGJhc2U2NC5oYXNPd25Qcm9wZXJ0eShrZXkpICYmIChmcmVlRXhwb3J0c1trZXldID0gYmFzZTY0W2tleV0pO1xuXHRcdFx0fVxuXHRcdH1cblx0fSBlbHNlIHsgLy8gaW4gUmhpbm8gb3IgYSB3ZWIgYnJvd3NlclxuXHRcdHJvb3QuYmFzZTY0ID0gYmFzZTY0O1xuXHR9XG5cbn0odGhpcykpO1xuIl19","/*!\n * jsUri\n * https://github.com/derek-watson/jsUri\n *\n * Copyright 2013, Derek Watson\n * Released under the MIT license.\n *\n * Includes parseUri regular expressions\n * http://blog.stevenlevithan.com/archives/parseuri\n * Copyright 2007, Steven Levithan\n * Released under the MIT license.\n */\n\n /*globals define, module */\n\n(function(global) {\n\n  var re = {\n    starts_with_slashes: /^\\/+/,\n    ends_with_slashes: /\\/+$/,\n    pluses: /\\+/g,\n    query_separator: /[&;]/,\n    uri_parser: /^(?:(?![^:@]+:[^:@\\/]*@)([^:\\/?#.]+):)?(?:\\/\\/)?((?:(([^:@\\/]*)(?::([^:@]*))?)?@)?(\\[[0-9a-fA-F:.]+\\]|[^:\\/?#]*)(?::(\\d+|(?=:)))?(:)?)((((?:[^?#](?![^?#\\/]*\\.[^?#\\/.]+(?:[?#]|$)))*\\/?)?([^?#\\/]*))(?:\\?([^#]*))?(?:#(.*))?)/\n  };\n\n  /**\n   * Define forEach for older js environments\n   * @see https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/forEach#Compatibility\n   */\n  if (!Array.prototype.forEach) {\n    Array.prototype.forEach = function(callback, thisArg) {\n      var T, k;\n\n      if (this == null) {\n        throw new TypeError(' this is null or not defined');\n      }\n\n      var O = Object(this);\n      var len = O.length >>> 0;\n\n      if (typeof callback !== \"function\") {\n        throw new TypeError(callback + ' is not a function');\n      }\n\n      if (arguments.length > 1) {\n        T = thisArg;\n      }\n\n      k = 0;\n\n      while (k < len) {\n        var kValue;\n        if (k in O) {\n          kValue = O[k];\n          callback.call(T, kValue, k, O);\n        }\n        k++;\n      }\n    };\n  }\n\n  /**\n   * unescape a query param value\n   * @param  {string} s encoded value\n   * @return {string}   decoded value\n   */\n  function decode(s) {\n    if (s) {\n        s = s.toString().replace(re.pluses, '%20');\n        s = decodeURIComponent(s);\n    }\n    return s;\n  }\n\n  /**\n   * Breaks a uri string down into its individual parts\n   * @param  {string} str uri\n   * @return {object}     parts\n   */\n  function parseUri(str) {\n    var parser = re.uri_parser;\n    var parserKeys = [\"source\", \"protocol\", \"authority\", \"userInfo\", \"user\", \"password\", \"host\", \"port\", \"isColonUri\", \"relative\", \"path\", \"directory\", \"file\", \"query\", \"anchor\"];\n    var m = parser.exec(str || '');\n    var parts = {};\n\n    parserKeys.forEach(function(key, i) {\n      parts[key] = m[i] || '';\n    });\n\n    return parts;\n  }\n\n  /**\n   * Breaks a query string down into an array of key/value pairs\n   * @param  {string} str query\n   * @return {array}      array of arrays (key/value pairs)\n   */\n  function parseQuery(str) {\n    var i, ps, p, n, k, v, l;\n    var pairs = [];\n\n    if (typeof(str) === 'undefined' || str === null || str === '') {\n      return pairs;\n    }\n\n    if (str.indexOf('?') === 0) {\n      str = str.substring(1);\n    }\n\n    ps = str.toString().split(re.query_separator);\n\n    for (i = 0, l = ps.length; i < l; i++) {\n      p = ps[i];\n      n = p.indexOf('=');\n\n      if (n !== 0) {\n        k = decode(p.substring(0, n));\n        v = decode(p.substring(n + 1));\n        pairs.push(n === -1 ? [p, null] : [k, v]);\n      }\n\n    }\n    return pairs;\n  }\n\n  /**\n   * Creates a new Uri object\n   * @constructor\n   * @param {string} str\n   */\n  function Uri(str) {\n    this.uriParts = parseUri(str);\n    this.queryPairs = parseQuery(this.uriParts.query);\n    this.hasAuthorityPrefixUserPref = null;\n  }\n\n  /**\n   * Define getter/setter methods\n   */\n  ['protocol', 'userInfo', 'host', 'port', 'path', 'anchor'].forEach(function(key) {\n    Uri.prototype[key] = function(val) {\n      if (typeof val !== 'undefined') {\n        this.uriParts[key] = val;\n      }\n      return this.uriParts[key];\n    };\n  });\n\n  /**\n   * if there is no protocol, the leading // can be enabled or disabled\n   * @param  {Boolean}  val\n   * @return {Boolean}\n   */\n  Uri.prototype.hasAuthorityPrefix = function(val) {\n    if (typeof val !== 'undefined') {\n      this.hasAuthorityPrefixUserPref = val;\n    }\n\n    if (this.hasAuthorityPrefixUserPref === null) {\n      return (this.uriParts.source.indexOf('//') !== -1);\n    } else {\n      return this.hasAuthorityPrefixUserPref;\n    }\n  };\n\n  Uri.prototype.isColonUri = function (val) {\n    if (typeof val !== 'undefined') {\n      this.uriParts.isColonUri = !!val;\n    } else {\n      return !!this.uriParts.isColonUri;\n    }\n  };\n\n  /**\n   * Serializes the internal state of the query pairs\n   * @param  {string} [val]   set a new query string\n   * @return {string}         query string\n   */\n  Uri.prototype.query = function(val) {\n    var s = '', i, param, l;\n\n    if (typeof val !== 'undefined') {\n      this.queryPairs = parseQuery(val);\n    }\n\n    for (i = 0, l = this.queryPairs.length; i < l; i++) {\n      param = this.queryPairs[i];\n      if (s.length > 0) {\n        s += '&';\n      }\n      if (param[1] === null) {\n        s += param[0];\n      } else {\n        s += param[0];\n        s += '=';\n        if (typeof param[1] !== 'undefined') {\n          s += encodeURIComponent(param[1]);\n        }\n      }\n    }\n    return s.length > 0 ? '?' + s : s;\n  };\n\n  /**\n   * returns the first query param value found for the key\n   * @param  {string} key query key\n   * @return {string}     first value found for key\n   */\n  Uri.prototype.getQueryParamValue = function (key) {\n    var param, i, l;\n    for (i = 0, l = this.queryPairs.length; i < l; i++) {\n      param = this.queryPairs[i];\n      if (key === param[0]) {\n        return param[1];\n      }\n    }\n  };\n\n  /**\n   * returns an array of query param values for the key\n   * @param  {string} key query key\n   * @return {array}      array of values\n   */\n  Uri.prototype.getQueryParamValues = function (key) {\n    var arr = [], i, param, l;\n    for (i = 0, l = this.queryPairs.length; i < l; i++) {\n      param = this.queryPairs[i];\n      if (key === param[0]) {\n        arr.push(param[1]);\n      }\n    }\n    return arr;\n  };\n\n  /**\n   * removes query parameters\n   * @param  {string} key     remove values for key\n   * @param  {val}    [val]   remove a specific value, otherwise removes all\n   * @return {Uri}            returns self for fluent chaining\n   */\n  Uri.prototype.deleteQueryParam = function (key, val) {\n    var arr = [], i, param, keyMatchesFilter, valMatchesFilter, l;\n\n    for (i = 0, l = this.queryPairs.length; i < l; i++) {\n\n      param = this.queryPairs[i];\n      keyMatchesFilter = decode(param[0]) === decode(key);\n      valMatchesFilter = param[1] === val;\n\n      if ((arguments.length === 1 && !keyMatchesFilter) || (arguments.length === 2 && (!keyMatchesFilter || !valMatchesFilter))) {\n        arr.push(param);\n      }\n    }\n\n    this.queryPairs = arr;\n\n    return this;\n  };\n\n  /**\n   * adds a query parameter\n   * @param  {string}  key        add values for key\n   * @param  {string}  val        value to add\n   * @param  {integer} [index]    specific index to add the value at\n   * @return {Uri}                returns self for fluent chaining\n   */\n  Uri.prototype.addQueryParam = function (key, val, index) {\n    if (arguments.length === 3 && index !== -1) {\n      index = Math.min(index, this.queryPairs.length);\n      this.queryPairs.splice(index, 0, [key, val]);\n    } else if (arguments.length > 0) {\n      this.queryPairs.push([key, val]);\n    }\n    return this;\n  };\n\n  /**\n   * test for the existence of a query parameter\n   * @param  {string}  key        add values for key\n   * @param  {string}  val        value to add\n   * @param  {integer} [index]    specific index to add the value at\n   * @return {Uri}                returns self for fluent chaining\n   */\n  Uri.prototype.hasQueryParam = function (key) {\n    var i, len = this.queryPairs.length;\n    for (i = 0; i < len; i++) {\n      if (this.queryPairs[i][0] == key)\n        return true;\n    }\n    return false;\n  };\n\n  /**\n   * replaces query param values\n   * @param  {string} key         key to replace value for\n   * @param  {string} newVal      new value\n   * @param  {string} [oldVal]    replace only one specific value (otherwise replaces all)\n   * @return {Uri}                returns self for fluent chaining\n   */\n  Uri.prototype.replaceQueryParam = function (key, newVal, oldVal) {\n    var index = -1, len = this.queryPairs.length, i, param;\n\n    if (arguments.length === 3) {\n      for (i = 0; i < len; i++) {\n        param = this.queryPairs[i];\n        if (decode(param[0]) === decode(key) && decodeURIComponent(param[1]) === decode(oldVal)) {\n          index = i;\n          break;\n        }\n      }\n      if (index >= 0) {\n        this.deleteQueryParam(key, decode(oldVal)).addQueryParam(key, newVal, index);\n      }\n    } else {\n      for (i = 0; i < len; i++) {\n        param = this.queryPairs[i];\n        if (decode(param[0]) === decode(key)) {\n          index = i;\n          break;\n        }\n      }\n      this.deleteQueryParam(key);\n      this.addQueryParam(key, newVal, index);\n    }\n    return this;\n  };\n\n  /**\n   * Define fluent setter methods (setProtocol, setHasAuthorityPrefix, etc)\n   */\n  ['protocol', 'hasAuthorityPrefix', 'isColonUri', 'userInfo', 'host', 'port', 'path', 'query', 'anchor'].forEach(function(key) {\n    var method = 'set' + key.charAt(0).toUpperCase() + key.slice(1);\n    Uri.prototype[method] = function(val) {\n      this[key](val);\n      return this;\n    };\n  });\n\n  /**\n   * Scheme name, colon and doubleslash, as required\n   * @return {string} http:// or possibly just //\n   */\n  Uri.prototype.scheme = function() {\n    var s = '';\n\n    if (this.protocol()) {\n      s += this.protocol();\n      if (this.protocol().indexOf(':') !== this.protocol().length - 1) {\n        s += ':';\n      }\n      s += '//';\n    } else {\n      if (this.hasAuthorityPrefix() && this.host()) {\n        s += '//';\n      }\n    }\n\n    return s;\n  };\n\n  /**\n   * Same as Mozilla nsIURI.prePath\n   * @return {string} scheme://user:password@host:port\n   * @see  https://developer.mozilla.org/en/nsIURI\n   */\n  Uri.prototype.origin = function() {\n    var s = this.scheme();\n\n    if (this.userInfo() && this.host()) {\n      s += this.userInfo();\n      if (this.userInfo().indexOf('@') !== this.userInfo().length - 1) {\n        s += '@';\n      }\n    }\n\n    if (this.host()) {\n      s += this.host();\n      if (this.port() || (this.path() && this.path().substr(0, 1).match(/[0-9]/))) {\n        s += ':' + this.port();\n      }\n    }\n\n    return s;\n  };\n\n  /**\n   * Adds a trailing slash to the path\n   */\n  Uri.prototype.addTrailingSlash = function() {\n    var path = this.path() || '';\n\n    if (path.substr(-1) !== '/') {\n      this.path(path + '/');\n    }\n\n    return this;\n  };\n\n  /**\n   * Serializes the internal state of the Uri object\n   * @return {string}\n   */\n  Uri.prototype.toString = function() {\n    var path, s = this.origin();\n\n    if (this.isColonUri()) {\n      if (this.path()) {\n        s += ':'+this.path();\n      }\n    } else if (this.path()) {\n      path = this.path();\n      if (!(re.ends_with_slashes.test(s) || re.starts_with_slashes.test(path))) {\n        s += '/';\n      } else {\n        if (s) {\n          s.replace(re.ends_with_slashes, '/');\n        }\n        path = path.replace(re.starts_with_slashes, '/');\n      }\n      s += path;\n    } else {\n      if (this.host() && (this.query().toString() || this.anchor())) {\n        s += '/';\n      }\n    }\n    if (this.query().toString()) {\n      s += this.query().toString();\n    }\n\n    if (this.anchor()) {\n      if (this.anchor().indexOf('#') !== 0) {\n        s += '#';\n      }\n      s += this.anchor();\n    }\n\n    return s;\n  };\n\n  /**\n   * Clone a Uri object\n   * @return {Uri} duplicate copy of the Uri\n   */\n  Uri.prototype.clone = function() {\n    return new Uri(this.toString());\n  };\n\n  /**\n   * export via AMD or CommonJS, otherwise leak a global\n   */\n  if (typeof define === 'function' && define.amd) {\n    define(function() {\n      return Uri;\n    });\n  } else if (typeof module !== 'undefined' && typeof module.exports !== 'undefined') {\n    module.exports = Uri;\n  } else {\n    global.Uri = Uri;\n  }\n}(this));\n","(function (global){\n/*! https://mths.be/utf8js v2.0.0 by @mathias */\n;(function(root) {\n\n\t// Detect free variables `exports`\n\tvar freeExports = typeof exports == 'object' && exports;\n\n\t// Detect free variable `module`\n\tvar freeModule = typeof module == 'object' && module &&\n\t\tmodule.exports == freeExports && module;\n\n\t// Detect free variable `global`, from Node.js or Browserified code,\n\t// and use it as `root`\n\tvar freeGlobal = typeof global == 'object' && global;\n\tif (freeGlobal.global === freeGlobal || freeGlobal.window === freeGlobal) {\n\t\troot = freeGlobal;\n\t}\n\n\t/*--------------------------------------------------------------------------*/\n\n\tvar stringFromCharCode = String.fromCharCode;\n\n\t// Taken from https://mths.be/punycode\n\tfunction ucs2decode(string) {\n\t\tvar output = [];\n\t\tvar counter = 0;\n\t\tvar length = string.length;\n\t\tvar value;\n\t\tvar extra;\n\t\twhile (counter < length) {\n\t\t\tvalue = string.charCodeAt(counter++);\n\t\t\tif (value >= 0xD800 && value <= 0xDBFF && counter < length) {\n\t\t\t\t// high surrogate, and there is a next character\n\t\t\t\textra = string.charCodeAt(counter++);\n\t\t\t\tif ((extra & 0xFC00) == 0xDC00) { // low surrogate\n\t\t\t\t\toutput.push(((value & 0x3FF) << 10) + (extra & 0x3FF) + 0x10000);\n\t\t\t\t} else {\n\t\t\t\t\t// unmatched surrogate; only append this code unit, in case the next\n\t\t\t\t\t// code unit is the high surrogate of a surrogate pair\n\t\t\t\t\toutput.push(value);\n\t\t\t\t\tcounter--;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\toutput.push(value);\n\t\t\t}\n\t\t}\n\t\treturn output;\n\t}\n\n\t// Taken from https://mths.be/punycode\n\tfunction ucs2encode(array) {\n\t\tvar length = array.length;\n\t\tvar index = -1;\n\t\tvar value;\n\t\tvar output = '';\n\t\twhile (++index < length) {\n\t\t\tvalue = array[index];\n\t\t\tif (value > 0xFFFF) {\n\t\t\t\tvalue -= 0x10000;\n\t\t\t\toutput += stringFromCharCode(value >>> 10 & 0x3FF | 0xD800);\n\t\t\t\tvalue = 0xDC00 | value & 0x3FF;\n\t\t\t}\n\t\t\toutput += stringFromCharCode(value);\n\t\t}\n\t\treturn output;\n\t}\n\n\tfunction checkScalarValue(codePoint) {\n\t\tif (codePoint >= 0xD800 && codePoint <= 0xDFFF) {\n\t\t\tthrow Error(\n\t\t\t\t'Lone surrogate U+' + codePoint.toString(16).toUpperCase() +\n\t\t\t\t' is not a scalar value'\n\t\t\t);\n\t\t}\n\t}\n\t/*--------------------------------------------------------------------------*/\n\n\tfunction createByte(codePoint, shift) {\n\t\treturn stringFromCharCode(((codePoint >> shift) & 0x3F) | 0x80);\n\t}\n\n\tfunction encodeCodePoint(codePoint) {\n\t\tif ((codePoint & 0xFFFFFF80) == 0) { // 1-byte sequence\n\t\t\treturn stringFromCharCode(codePoint);\n\t\t}\n\t\tvar symbol = '';\n\t\tif ((codePoint & 0xFFFFF800) == 0) { // 2-byte sequence\n\t\t\tsymbol = stringFromCharCode(((codePoint >> 6) & 0x1F) | 0xC0);\n\t\t}\n\t\telse if ((codePoint & 0xFFFF0000) == 0) { // 3-byte sequence\n\t\t\tcheckScalarValue(codePoint);\n\t\t\tsymbol = stringFromCharCode(((codePoint >> 12) & 0x0F) | 0xE0);\n\t\t\tsymbol += createByte(codePoint, 6);\n\t\t}\n\t\telse if ((codePoint & 0xFFE00000) == 0) { // 4-byte sequence\n\t\t\tsymbol = stringFromCharCode(((codePoint >> 18) & 0x07) | 0xF0);\n\t\t\tsymbol += createByte(codePoint, 12);\n\t\t\tsymbol += createByte(codePoint, 6);\n\t\t}\n\t\tsymbol += stringFromCharCode((codePoint & 0x3F) | 0x80);\n\t\treturn symbol;\n\t}\n\n\tfunction utf8encode(string) {\n\t\tvar codePoints = ucs2decode(string);\n\t\tvar length = codePoints.length;\n\t\tvar index = -1;\n\t\tvar codePoint;\n\t\tvar byteString = '';\n\t\twhile (++index < length) {\n\t\t\tcodePoint = codePoints[index];\n\t\t\tbyteString += encodeCodePoint(codePoint);\n\t\t}\n\t\treturn byteString;\n\t}\n\n\t/*--------------------------------------------------------------------------*/\n\n\tfunction readContinuationByte() {\n\t\tif (byteIndex >= byteCount) {\n\t\t\tthrow Error('Invalid byte index');\n\t\t}\n\n\t\tvar continuationByte = byteArray[byteIndex] & 0xFF;\n\t\tbyteIndex++;\n\n\t\tif ((continuationByte & 0xC0) == 0x80) {\n\t\t\treturn continuationByte & 0x3F;\n\t\t}\n\n\t\t// If we end up here, it’s not a continuation byte\n\t\tthrow Error('Invalid continuation byte');\n\t}\n\n\tfunction decodeSymbol() {\n\t\tvar byte1;\n\t\tvar byte2;\n\t\tvar byte3;\n\t\tvar byte4;\n\t\tvar codePoint;\n\n\t\tif (byteIndex > byteCount) {\n\t\t\tthrow Error('Invalid byte index');\n\t\t}\n\n\t\tif (byteIndex == byteCount) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Read first byte\n\t\tbyte1 = byteArray[byteIndex] & 0xFF;\n\t\tbyteIndex++;\n\n\t\t// 1-byte sequence (no continuation bytes)\n\t\tif ((byte1 & 0x80) == 0) {\n\t\t\treturn byte1;\n\t\t}\n\n\t\t// 2-byte sequence\n\t\tif ((byte1 & 0xE0) == 0xC0) {\n\t\t\tvar byte2 = readContinuationByte();\n\t\t\tcodePoint = ((byte1 & 0x1F) << 6) | byte2;\n\t\t\tif (codePoint >= 0x80) {\n\t\t\t\treturn codePoint;\n\t\t\t} else {\n\t\t\t\tthrow Error('Invalid continuation byte');\n\t\t\t}\n\t\t}\n\n\t\t// 3-byte sequence (may include unpaired surrogates)\n\t\tif ((byte1 & 0xF0) == 0xE0) {\n\t\t\tbyte2 = readContinuationByte();\n\t\t\tbyte3 = readContinuationByte();\n\t\t\tcodePoint = ((byte1 & 0x0F) << 12) | (byte2 << 6) | byte3;\n\t\t\tif (codePoint >= 0x0800) {\n\t\t\t\tcheckScalarValue(codePoint);\n\t\t\t\treturn codePoint;\n\t\t\t} else {\n\t\t\t\tthrow Error('Invalid continuation byte');\n\t\t\t}\n\t\t}\n\n\t\t// 4-byte sequence\n\t\tif ((byte1 & 0xF8) == 0xF0) {\n\t\t\tbyte2 = readContinuationByte();\n\t\t\tbyte3 = readContinuationByte();\n\t\t\tbyte4 = readContinuationByte();\n\t\t\tcodePoint = ((byte1 & 0x0F) << 0x12) | (byte2 << 0x0C) |\n\t\t\t\t(byte3 << 0x06) | byte4;\n\t\t\tif (codePoint >= 0x010000 && codePoint <= 0x10FFFF) {\n\t\t\t\treturn codePoint;\n\t\t\t}\n\t\t}\n\n\t\tthrow Error('Invalid UTF-8 detected');\n\t}\n\n\tvar byteArray;\n\tvar byteCount;\n\tvar byteIndex;\n\tfunction utf8decode(byteString) {\n\t\tbyteArray = ucs2decode(byteString);\n\t\tbyteCount = byteArray.length;\n\t\tbyteIndex = 0;\n\t\tvar codePoints = [];\n\t\tvar tmp;\n\t\twhile ((tmp = decodeSymbol()) !== false) {\n\t\t\tcodePoints.push(tmp);\n\t\t}\n\t\treturn ucs2encode(codePoints);\n\t}\n\n\t/*--------------------------------------------------------------------------*/\n\n\tvar utf8 = {\n\t\t'version': '2.0.0',\n\t\t'encode': utf8encode,\n\t\t'decode': utf8decode\n\t};\n\n\t// Some AMD build optimizers, like r.js, check for specific condition patterns\n\t// like the following:\n\tif (\n\t\ttypeof define == 'function' &&\n\t\ttypeof define.amd == 'object' &&\n\t\tdefine.amd\n\t) {\n\t\tdefine(function() {\n\t\t\treturn utf8;\n\t\t});\n\t}\telse if (freeExports && !freeExports.nodeType) {\n\t\tif (freeModule) { // in Node.js or RingoJS v0.8.0+\n\t\t\tfreeModule.exports = utf8;\n\t\t} else { // in Narwhal or RingoJS v0.7.0-\n\t\t\tvar object = {};\n\t\t\tvar hasOwnProperty = object.hasOwnProperty;\n\t\t\tfor (var key in utf8) {\n\t\t\t\thasOwnProperty.call(utf8, key) && (freeExports[key] = utf8[key]);\n\t\t\t}\n\t\t}\n\t} else { // in Rhino or a web browser\n\t\troot.utf8 = utf8;\n\t}\n\n}(this));\n\n}).call(this,typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy91dGY4L3V0ZjguanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIi8qISBodHRwczovL210aHMuYmUvdXRmOGpzIHYyLjAuMCBieSBAbWF0aGlhcyAqL1xuOyhmdW5jdGlvbihyb290KSB7XG5cblx0Ly8gRGV0ZWN0IGZyZWUgdmFyaWFibGVzIGBleHBvcnRzYFxuXHR2YXIgZnJlZUV4cG9ydHMgPSB0eXBlb2YgZXhwb3J0cyA9PSAnb2JqZWN0JyAmJiBleHBvcnRzO1xuXG5cdC8vIERldGVjdCBmcmVlIHZhcmlhYmxlIGBtb2R1bGVgXG5cdHZhciBmcmVlTW9kdWxlID0gdHlwZW9mIG1vZHVsZSA9PSAnb2JqZWN0JyAmJiBtb2R1bGUgJiZcblx0XHRtb2R1bGUuZXhwb3J0cyA9PSBmcmVlRXhwb3J0cyAmJiBtb2R1bGU7XG5cblx0Ly8gRGV0ZWN0IGZyZWUgdmFyaWFibGUgYGdsb2JhbGAsIGZyb20gTm9kZS5qcyBvciBCcm93c2VyaWZpZWQgY29kZSxcblx0Ly8gYW5kIHVzZSBpdCBhcyBgcm9vdGBcblx0dmFyIGZyZWVHbG9iYWwgPSB0eXBlb2YgZ2xvYmFsID09ICdvYmplY3QnICYmIGdsb2JhbDtcblx0aWYgKGZyZWVHbG9iYWwuZ2xvYmFsID09PSBmcmVlR2xvYmFsIHx8IGZyZWVHbG9iYWwud2luZG93ID09PSBmcmVlR2xvYmFsKSB7XG5cdFx0cm9vdCA9IGZyZWVHbG9iYWw7XG5cdH1cblxuXHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHR2YXIgc3RyaW5nRnJvbUNoYXJDb2RlID0gU3RyaW5nLmZyb21DaGFyQ29kZTtcblxuXHQvLyBUYWtlbiBmcm9tIGh0dHBzOi8vbXRocy5iZS9wdW55Y29kZVxuXHRmdW5jdGlvbiB1Y3MyZGVjb2RlKHN0cmluZykge1xuXHRcdHZhciBvdXRwdXQgPSBbXTtcblx0XHR2YXIgY291bnRlciA9IDA7XG5cdFx0dmFyIGxlbmd0aCA9IHN0cmluZy5sZW5ndGg7XG5cdFx0dmFyIHZhbHVlO1xuXHRcdHZhciBleHRyYTtcblx0XHR3aGlsZSAoY291bnRlciA8IGxlbmd0aCkge1xuXHRcdFx0dmFsdWUgPSBzdHJpbmcuY2hhckNvZGVBdChjb3VudGVyKyspO1xuXHRcdFx0aWYgKHZhbHVlID49IDB4RDgwMCAmJiB2YWx1ZSA8PSAweERCRkYgJiYgY291bnRlciA8IGxlbmd0aCkge1xuXHRcdFx0XHQvLyBoaWdoIHN1cnJvZ2F0ZSwgYW5kIHRoZXJlIGlzIGEgbmV4dCBjaGFyYWN0ZXJcblx0XHRcdFx0ZXh0cmEgPSBzdHJpbmcuY2hhckNvZGVBdChjb3VudGVyKyspO1xuXHRcdFx0XHRpZiAoKGV4dHJhICYgMHhGQzAwKSA9PSAweERDMDApIHsgLy8gbG93IHN1cnJvZ2F0ZVxuXHRcdFx0XHRcdG91dHB1dC5wdXNoKCgodmFsdWUgJiAweDNGRikgPDwgMTApICsgKGV4dHJhICYgMHgzRkYpICsgMHgxMDAwMCk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Ly8gdW5tYXRjaGVkIHN1cnJvZ2F0ZTsgb25seSBhcHBlbmQgdGhpcyBjb2RlIHVuaXQsIGluIGNhc2UgdGhlIG5leHRcblx0XHRcdFx0XHQvLyBjb2RlIHVuaXQgaXMgdGhlIGhpZ2ggc3Vycm9nYXRlIG9mIGEgc3Vycm9nYXRlIHBhaXJcblx0XHRcdFx0XHRvdXRwdXQucHVzaCh2YWx1ZSk7XG5cdFx0XHRcdFx0Y291bnRlci0tO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRvdXRwdXQucHVzaCh2YWx1ZSk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiBvdXRwdXQ7XG5cdH1cblxuXHQvLyBUYWtlbiBmcm9tIGh0dHBzOi8vbXRocy5iZS9wdW55Y29kZVxuXHRmdW5jdGlvbiB1Y3MyZW5jb2RlKGFycmF5KSB7XG5cdFx0dmFyIGxlbmd0aCA9IGFycmF5Lmxlbmd0aDtcblx0XHR2YXIgaW5kZXggPSAtMTtcblx0XHR2YXIgdmFsdWU7XG5cdFx0dmFyIG91dHB1dCA9ICcnO1xuXHRcdHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG5cdFx0XHR2YWx1ZSA9IGFycmF5W2luZGV4XTtcblx0XHRcdGlmICh2YWx1ZSA+IDB4RkZGRikge1xuXHRcdFx0XHR2YWx1ZSAtPSAweDEwMDAwO1xuXHRcdFx0XHRvdXRwdXQgKz0gc3RyaW5nRnJvbUNoYXJDb2RlKHZhbHVlID4+PiAxMCAmIDB4M0ZGIHwgMHhEODAwKTtcblx0XHRcdFx0dmFsdWUgPSAweERDMDAgfCB2YWx1ZSAmIDB4M0ZGO1xuXHRcdFx0fVxuXHRcdFx0b3V0cHV0ICs9IHN0cmluZ0Zyb21DaGFyQ29kZSh2YWx1ZSk7XG5cdFx0fVxuXHRcdHJldHVybiBvdXRwdXQ7XG5cdH1cblxuXHRmdW5jdGlvbiBjaGVja1NjYWxhclZhbHVlKGNvZGVQb2ludCkge1xuXHRcdGlmIChjb2RlUG9pbnQgPj0gMHhEODAwICYmIGNvZGVQb2ludCA8PSAweERGRkYpIHtcblx0XHRcdHRocm93IEVycm9yKFxuXHRcdFx0XHQnTG9uZSBzdXJyb2dhdGUgVSsnICsgY29kZVBvaW50LnRvU3RyaW5nKDE2KS50b1VwcGVyQ2FzZSgpICtcblx0XHRcdFx0JyBpcyBub3QgYSBzY2FsYXIgdmFsdWUnXG5cdFx0XHQpO1xuXHRcdH1cblx0fVxuXHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRmdW5jdGlvbiBjcmVhdGVCeXRlKGNvZGVQb2ludCwgc2hpZnQpIHtcblx0XHRyZXR1cm4gc3RyaW5nRnJvbUNoYXJDb2RlKCgoY29kZVBvaW50ID4+IHNoaWZ0KSAmIDB4M0YpIHwgMHg4MCk7XG5cdH1cblxuXHRmdW5jdGlvbiBlbmNvZGVDb2RlUG9pbnQoY29kZVBvaW50KSB7XG5cdFx0aWYgKChjb2RlUG9pbnQgJiAweEZGRkZGRjgwKSA9PSAwKSB7IC8vIDEtYnl0ZSBzZXF1ZW5jZVxuXHRcdFx0cmV0dXJuIHN0cmluZ0Zyb21DaGFyQ29kZShjb2RlUG9pbnQpO1xuXHRcdH1cblx0XHR2YXIgc3ltYm9sID0gJyc7XG5cdFx0aWYgKChjb2RlUG9pbnQgJiAweEZGRkZGODAwKSA9PSAwKSB7IC8vIDItYnl0ZSBzZXF1ZW5jZVxuXHRcdFx0c3ltYm9sID0gc3RyaW5nRnJvbUNoYXJDb2RlKCgoY29kZVBvaW50ID4+IDYpICYgMHgxRikgfCAweEMwKTtcblx0XHR9XG5cdFx0ZWxzZSBpZiAoKGNvZGVQb2ludCAmIDB4RkZGRjAwMDApID09IDApIHsgLy8gMy1ieXRlIHNlcXVlbmNlXG5cdFx0XHRjaGVja1NjYWxhclZhbHVlKGNvZGVQb2ludCk7XG5cdFx0XHRzeW1ib2wgPSBzdHJpbmdGcm9tQ2hhckNvZGUoKChjb2RlUG9pbnQgPj4gMTIpICYgMHgwRikgfCAweEUwKTtcblx0XHRcdHN5bWJvbCArPSBjcmVhdGVCeXRlKGNvZGVQb2ludCwgNik7XG5cdFx0fVxuXHRcdGVsc2UgaWYgKChjb2RlUG9pbnQgJiAweEZGRTAwMDAwKSA9PSAwKSB7IC8vIDQtYnl0ZSBzZXF1ZW5jZVxuXHRcdFx0c3ltYm9sID0gc3RyaW5nRnJvbUNoYXJDb2RlKCgoY29kZVBvaW50ID4+IDE4KSAmIDB4MDcpIHwgMHhGMCk7XG5cdFx0XHRzeW1ib2wgKz0gY3JlYXRlQnl0ZShjb2RlUG9pbnQsIDEyKTtcblx0XHRcdHN5bWJvbCArPSBjcmVhdGVCeXRlKGNvZGVQb2ludCwgNik7XG5cdFx0fVxuXHRcdHN5bWJvbCArPSBzdHJpbmdGcm9tQ2hhckNvZGUoKGNvZGVQb2ludCAmIDB4M0YpIHwgMHg4MCk7XG5cdFx0cmV0dXJuIHN5bWJvbDtcblx0fVxuXG5cdGZ1bmN0aW9uIHV0ZjhlbmNvZGUoc3RyaW5nKSB7XG5cdFx0dmFyIGNvZGVQb2ludHMgPSB1Y3MyZGVjb2RlKHN0cmluZyk7XG5cdFx0dmFyIGxlbmd0aCA9IGNvZGVQb2ludHMubGVuZ3RoO1xuXHRcdHZhciBpbmRleCA9IC0xO1xuXHRcdHZhciBjb2RlUG9pbnQ7XG5cdFx0dmFyIGJ5dGVTdHJpbmcgPSAnJztcblx0XHR3aGlsZSAoKytpbmRleCA8IGxlbmd0aCkge1xuXHRcdFx0Y29kZVBvaW50ID0gY29kZVBvaW50c1tpbmRleF07XG5cdFx0XHRieXRlU3RyaW5nICs9IGVuY29kZUNvZGVQb2ludChjb2RlUG9pbnQpO1xuXHRcdH1cblx0XHRyZXR1cm4gYnl0ZVN0cmluZztcblx0fVxuXG5cdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdGZ1bmN0aW9uIHJlYWRDb250aW51YXRpb25CeXRlKCkge1xuXHRcdGlmIChieXRlSW5kZXggPj0gYnl0ZUNvdW50KSB7XG5cdFx0XHR0aHJvdyBFcnJvcignSW52YWxpZCBieXRlIGluZGV4Jyk7XG5cdFx0fVxuXG5cdFx0dmFyIGNvbnRpbnVhdGlvbkJ5dGUgPSBieXRlQXJyYXlbYnl0ZUluZGV4XSAmIDB4RkY7XG5cdFx0Ynl0ZUluZGV4Kys7XG5cblx0XHRpZiAoKGNvbnRpbnVhdGlvbkJ5dGUgJiAweEMwKSA9PSAweDgwKSB7XG5cdFx0XHRyZXR1cm4gY29udGludWF0aW9uQnl0ZSAmIDB4M0Y7XG5cdFx0fVxuXG5cdFx0Ly8gSWYgd2UgZW5kIHVwIGhlcmUsIGl04oCZcyBub3QgYSBjb250aW51YXRpb24gYnl0ZVxuXHRcdHRocm93IEVycm9yKCdJbnZhbGlkIGNvbnRpbnVhdGlvbiBieXRlJyk7XG5cdH1cblxuXHRmdW5jdGlvbiBkZWNvZGVTeW1ib2woKSB7XG5cdFx0dmFyIGJ5dGUxO1xuXHRcdHZhciBieXRlMjtcblx0XHR2YXIgYnl0ZTM7XG5cdFx0dmFyIGJ5dGU0O1xuXHRcdHZhciBjb2RlUG9pbnQ7XG5cblx0XHRpZiAoYnl0ZUluZGV4ID4gYnl0ZUNvdW50KSB7XG5cdFx0XHR0aHJvdyBFcnJvcignSW52YWxpZCBieXRlIGluZGV4Jyk7XG5cdFx0fVxuXG5cdFx0aWYgKGJ5dGVJbmRleCA9PSBieXRlQ291bnQpIHtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cblx0XHQvLyBSZWFkIGZpcnN0IGJ5dGVcblx0XHRieXRlMSA9IGJ5dGVBcnJheVtieXRlSW5kZXhdICYgMHhGRjtcblx0XHRieXRlSW5kZXgrKztcblxuXHRcdC8vIDEtYnl0ZSBzZXF1ZW5jZSAobm8gY29udGludWF0aW9uIGJ5dGVzKVxuXHRcdGlmICgoYnl0ZTEgJiAweDgwKSA9PSAwKSB7XG5cdFx0XHRyZXR1cm4gYnl0ZTE7XG5cdFx0fVxuXG5cdFx0Ly8gMi1ieXRlIHNlcXVlbmNlXG5cdFx0aWYgKChieXRlMSAmIDB4RTApID09IDB4QzApIHtcblx0XHRcdHZhciBieXRlMiA9IHJlYWRDb250aW51YXRpb25CeXRlKCk7XG5cdFx0XHRjb2RlUG9pbnQgPSAoKGJ5dGUxICYgMHgxRikgPDwgNikgfCBieXRlMjtcblx0XHRcdGlmIChjb2RlUG9pbnQgPj0gMHg4MCkge1xuXHRcdFx0XHRyZXR1cm4gY29kZVBvaW50O1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhyb3cgRXJyb3IoJ0ludmFsaWQgY29udGludWF0aW9uIGJ5dGUnKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyAzLWJ5dGUgc2VxdWVuY2UgKG1heSBpbmNsdWRlIHVucGFpcmVkIHN1cnJvZ2F0ZXMpXG5cdFx0aWYgKChieXRlMSAmIDB4RjApID09IDB4RTApIHtcblx0XHRcdGJ5dGUyID0gcmVhZENvbnRpbnVhdGlvbkJ5dGUoKTtcblx0XHRcdGJ5dGUzID0gcmVhZENvbnRpbnVhdGlvbkJ5dGUoKTtcblx0XHRcdGNvZGVQb2ludCA9ICgoYnl0ZTEgJiAweDBGKSA8PCAxMikgfCAoYnl0ZTIgPDwgNikgfCBieXRlMztcblx0XHRcdGlmIChjb2RlUG9pbnQgPj0gMHgwODAwKSB7XG5cdFx0XHRcdGNoZWNrU2NhbGFyVmFsdWUoY29kZVBvaW50KTtcblx0XHRcdFx0cmV0dXJuIGNvZGVQb2ludDtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRocm93IEVycm9yKCdJbnZhbGlkIGNvbnRpbnVhdGlvbiBieXRlJyk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gNC1ieXRlIHNlcXVlbmNlXG5cdFx0aWYgKChieXRlMSAmIDB4RjgpID09IDB4RjApIHtcblx0XHRcdGJ5dGUyID0gcmVhZENvbnRpbnVhdGlvbkJ5dGUoKTtcblx0XHRcdGJ5dGUzID0gcmVhZENvbnRpbnVhdGlvbkJ5dGUoKTtcblx0XHRcdGJ5dGU0ID0gcmVhZENvbnRpbnVhdGlvbkJ5dGUoKTtcblx0XHRcdGNvZGVQb2ludCA9ICgoYnl0ZTEgJiAweDBGKSA8PCAweDEyKSB8IChieXRlMiA8PCAweDBDKSB8XG5cdFx0XHRcdChieXRlMyA8PCAweDA2KSB8IGJ5dGU0O1xuXHRcdFx0aWYgKGNvZGVQb2ludCA+PSAweDAxMDAwMCAmJiBjb2RlUG9pbnQgPD0gMHgxMEZGRkYpIHtcblx0XHRcdFx0cmV0dXJuIGNvZGVQb2ludDtcblx0XHRcdH1cblx0XHR9XG5cblx0XHR0aHJvdyBFcnJvcignSW52YWxpZCBVVEYtOCBkZXRlY3RlZCcpO1xuXHR9XG5cblx0dmFyIGJ5dGVBcnJheTtcblx0dmFyIGJ5dGVDb3VudDtcblx0dmFyIGJ5dGVJbmRleDtcblx0ZnVuY3Rpb24gdXRmOGRlY29kZShieXRlU3RyaW5nKSB7XG5cdFx0Ynl0ZUFycmF5ID0gdWNzMmRlY29kZShieXRlU3RyaW5nKTtcblx0XHRieXRlQ291bnQgPSBieXRlQXJyYXkubGVuZ3RoO1xuXHRcdGJ5dGVJbmRleCA9IDA7XG5cdFx0dmFyIGNvZGVQb2ludHMgPSBbXTtcblx0XHR2YXIgdG1wO1xuXHRcdHdoaWxlICgodG1wID0gZGVjb2RlU3ltYm9sKCkpICE9PSBmYWxzZSkge1xuXHRcdFx0Y29kZVBvaW50cy5wdXNoKHRtcCk7XG5cdFx0fVxuXHRcdHJldHVybiB1Y3MyZW5jb2RlKGNvZGVQb2ludHMpO1xuXHR9XG5cblx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0dmFyIHV0ZjggPSB7XG5cdFx0J3ZlcnNpb24nOiAnMi4wLjAnLFxuXHRcdCdlbmNvZGUnOiB1dGY4ZW5jb2RlLFxuXHRcdCdkZWNvZGUnOiB1dGY4ZGVjb2RlXG5cdH07XG5cblx0Ly8gU29tZSBBTUQgYnVpbGQgb3B0aW1pemVycywgbGlrZSByLmpzLCBjaGVjayBmb3Igc3BlY2lmaWMgY29uZGl0aW9uIHBhdHRlcm5zXG5cdC8vIGxpa2UgdGhlIGZvbGxvd2luZzpcblx0aWYgKFxuXHRcdHR5cGVvZiBkZWZpbmUgPT0gJ2Z1bmN0aW9uJyAmJlxuXHRcdHR5cGVvZiBkZWZpbmUuYW1kID09ICdvYmplY3QnICYmXG5cdFx0ZGVmaW5lLmFtZFxuXHQpIHtcblx0XHRkZWZpbmUoZnVuY3Rpb24oKSB7XG5cdFx0XHRyZXR1cm4gdXRmODtcblx0XHR9KTtcblx0fVx0ZWxzZSBpZiAoZnJlZUV4cG9ydHMgJiYgIWZyZWVFeHBvcnRzLm5vZGVUeXBlKSB7XG5cdFx0aWYgKGZyZWVNb2R1bGUpIHsgLy8gaW4gTm9kZS5qcyBvciBSaW5nb0pTIHYwLjguMCtcblx0XHRcdGZyZWVNb2R1bGUuZXhwb3J0cyA9IHV0Zjg7XG5cdFx0fSBlbHNlIHsgLy8gaW4gTmFyd2hhbCBvciBSaW5nb0pTIHYwLjcuMC1cblx0XHRcdHZhciBvYmplY3QgPSB7fTtcblx0XHRcdHZhciBoYXNPd25Qcm9wZXJ0eSA9IG9iamVjdC5oYXNPd25Qcm9wZXJ0eTtcblx0XHRcdGZvciAodmFyIGtleSBpbiB1dGY4KSB7XG5cdFx0XHRcdGhhc093blByb3BlcnR5LmNhbGwodXRmOCwga2V5KSAmJiAoZnJlZUV4cG9ydHNba2V5XSA9IHV0Zjhba2V5XSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9IGVsc2UgeyAvLyBpbiBSaGlubyBvciBhIHdlYiBicm93c2VyXG5cdFx0cm9vdC51dGY4ID0gdXRmODtcblx0fVxuXG59KHRoaXMpKTtcbiJdfQ==","import base64 from 'base-64';\nimport utf8 from 'utf8';\n\nexport default {\n    encode: function(string){\n        return base64.encode(utf8.encode(string));\n    },\n    decode: function(string){\n        return utf8.decode(base64.decode(string));\n    }\n};","var $;\nif (process.env.ENV === 'host') {\n    $ = require('../host/dollar');\n} else {\n    $ = require('../plugin/dollar');\n}\n\nexport default $;","'use strict';\n/**\n * Common methods for propagating DOM events between host/plugin iframes\n */\n\nvar w = window,\n        log = (w.AJS && w.AJS.log) || (w.console && w.console.log) || (function () {});\n\nvar SUPPORTED_MOUSE_EVENTS = [\n    'click'\n];\n\nvar SUPPORTED_KEYBOARD_EVENTS = [\n    'keydown',\n    'keyup'\n];\n\nvar ALLOWED_KEYCODES = [\n    27 // ESCAPE\n];\n\nexport default  {\n    // Public API\n    bindListeners,\n    receiveEvent,\n\n    // Visible for testing only\n    constructLegacyModifierString,\n    supportedMouseEvents: SUPPORTED_MOUSE_EVENTS,\n    supportedKeyboardEvents: SUPPORTED_KEYBOARD_EVENTS,\n    isAllowedKeyCode\n};\n\n/**\n * Bind listeners to the document to propagate events to the rpc endpoint\n *\n * @param {String} channelKey The unique key that identifies the rpc channel the listeners are bound to\n * @param {function} endpoint The rpc endpoint to send events to\n */\nfunction bindListeners(channelKey, endpoint) {\n    for (var mouseEvent of SUPPORTED_MOUSE_EVENTS) {\n        document.addEventListener(mouseEvent, function (e) {\n            if (e['channelKey'] == channelKey) {\n                return;\n            }\n            endpoint(channelKey, e.type, sanitiseMouseEvent(e))\n        })\n    }\n    for (var keyboardEvent of SUPPORTED_KEYBOARD_EVENTS) {\n        document.addEventListener(keyboardEvent, function (e) {\n            if (e['channelKey'] == channelKey) {\n                return;\n            }\n            // We don't want to send all keystrokes to addon pages (that would be bad)\n            if (isAllowedKeyCode(e.keyCode)) {\n                endpoint(channelKey, e.type, sanitiseKeyboardEvent(e))\n            }\n        });\n    }\n}\n\n/**\n * Receive a DOM event from the remote and dispatch to this page,\n * unless we have already seen it.\n *\n * @param channelKey The channel identifier\n * @param eventName The event received\n * @param eventData The data to attach to the event\n */\nfunction receiveEvent(channelKey, eventName, eventData) {\n    var event = createEvent(channelKey, eventName, eventData);\n    if (!event) {\n        return;\n    }\n\n    dispatchEvent(event);\n}\n\n/**\n * Return a sanitised data object that can be used to re-create\n * a synthetic click event\n *\n * @param {MouseEvent} mouseEvent The event to sanitise\n * @return {MouseEventInit} Sanitised data suitable for sending between iframes\n */\nfunction sanitiseMouseEvent(mouseEvent) {\n    return {\n        bubbles: true,\n        cancelable: true,\n        button: mouseEvent.button,\n        ctrlKey: mouseEvent.ctrlKey,\n        shiftKey: mouseEvent.shiftKey,\n        altKey: mouseEvent.altKey,\n        metaKey: mouseEvent.metaKey\n    }\n}\n\n/**\n * Return a sanitised data object that can be used to\n * re-create a synthetic keyboard event.\n *\n * @param {KeyboardEvent} keyboardEvent The event to sanitise\n * @return {KeyboardEventInit} Sanities data suitable for sending between iframes\n */\nfunction sanitiseKeyboardEvent(keyboardEvent) {\n    return {\n        bubbles: true,\n        cancelable: true,\n        key: keyboardEvent.key,\n        code: keyboardEvent.code,\n        keyCode: keyboardEvent.keyCode,\n        ctrlKey: keyboardEvent.ctrlKey,\n        shiftKey: keyboardEvent.shiftKey,\n        altKey: keyboardEvent.altKey,\n        metaKey: keyboardEvent.metaKey,\n        locale: null\n    }\n}\n\n/**\n * Create a synthetic DOM event using the provided data\n *\n * The returned event will include a param <code>channelKey</code> that can be\n * used to identify which channel the event was received on.\n *\n * @param {String} channelKey The key for the channel the event was received on\n * @param {String} eventName The name of the event to create\n * @param eventData The data to create the event with\n *\n * @returns {KeyboardEvent|MouseEvent} The constructed synthetic event\n */\nfunction createEvent(channelKey, eventName, eventData) {\n    eventData.view = window;\n\n    var event;\n    if (SUPPORTED_MOUSE_EVENTS.indexOf(eventName > -1)) {\n        if (typeof window.Event == 'function') {\n            event = new MouseEvent(eventName, eventData);\n        }\n        else {\n            // To support older browsers\n            // (e.g. IE - https://msdn.microsoft.com/en-us/library/dn905219%28v=vs.85%29.aspx)\n            event = document.createEvent('MouseEvent');\n            event.initMouseEvent(eventName,\n                    eventData.bubbles, eventData.cancelable, eventData.view,\n                    0, 0, 0, 0, 0,\n                    eventData.ctrlKey, eventData.altKey, eventData.shiftKey,\n                    eventData.metaKey, eventData.button, null);\n        }\n    }\n    else if (SUPPORTED_KEYBOARD_EVENTS.indexOf(eventName) > -1) {\n        if (typeof window.Event == 'function') {\n            event = new KeyboardEvent(eventName, eventData);\n        }\n        else {\n            // To support older browsers\n            // (e.g. IE - https://msdn.microsoft.com/en-us/library/dn905219%28v=vs.85%29.aspx)\n            event = document.createEvent('KeyboardEvent');\n            event.initKeyboardEvent(eventName,\n                    eventData.bubbles, eventData.cancelable, eventData.view,\n                    eventData.key, 0, constructLegacyModifierString(eventData),\n                    false, eventData.locale);\n        }\n    }\n    else {\n        log('Event ' + eventName + ' not supported');\n    }\n\n    if (event) {\n        event['channelKey'] = channelKey;\n    }\n    return event;\n}\n\n/**\n * Dispatch the given event to the current document\n *\n * Includes some AUI-specific dispatch if AUI is detected to ensure dialogs work correctly etc.\n *\n * @param event The event to dispatch\n */\nfunction dispatchEvent(event) {\n    document.body.dispatchEvent(event);\n\n    if (AJS && event.type == 'click') {\n        // If AJS is present we should fire the event on dialog curtains\n        // if they exist, to ensure AUI dialogs etc. are dismissed.\n        var blanket = AJS.$('.aui-blanket');\n        if (blanket.length > 0 && blanket[0]) {\n            blanket[0].dispatchEvent(event);\n        }\n    }\n}\n\n/**\n * Construct the legacy DOM L3 key modifier string required for pre-L4 keyboard event initialisation\n * @see https://msdn.microsoft.com/en-us/library/ff975297%28v=vs.85%29.aspx\n *\n * @param eventData\n * @returns {string} The modifier string (e.g. \"Ctr,Shift\")\n */\nfunction constructLegacyModifierString(eventData) {\n    var result = [];\n    if (eventData.shiftKey) {\n        result.push(\"Shift\");\n    }\n    if (eventData.ctrlKey) {\n        result.push(\"Ctrl\");\n    }\n    if (eventData.metaKey) {\n        result.push(\"Meta\");\n    }\n    if (eventData.altKey) {\n        result.push(\"Alt\");\n    }\n    return result.join(',');\n}\n\n/**\n * Determine if the provided keycode is allowed to be propagated between iframes\n *\n * @param keyCode The keycode to test\n *\n * @returns {boolean} Whether the provided keycode is allowed to be propagated between iframes\n */\nfunction isAllowedKeyCode(keyCode) {\n    return ALLOWED_KEYCODES.indexOf(keyCode) > -1;\n}","import $ from './dollar';\n\n  var w = window,\n      log = (w.AJS && w.AJS.log) || (w.console && w.console.log) || (function() {});\n\n  /**\n   * A simple pub/sub event bus capable of running on either side of the XDM bridge with no external\n   * JS lib dependencies.\n   *\n   * @param {String} key The key of the event source\n   * @param {String} origin The origin of the event source\n   * @constructor\n   */\n  function Events(key, origin) {\n    this._key = key;\n    this._origin = origin;\n    this._events = {};\n    this._any = [];\n  }\n\n  var proto = Events.prototype;\n\n  /**\n   * Subscribes a callback to an event name.\n   *\n   * @param {String} name The event name to subscribe the listener to\n   * @param {Function} listener A listener callback to subscribe to the event name\n   * @returns {Events} This Events instance\n   */\n  proto.on = function (name, listener) {\n    if (name && listener) {\n      this._listeners(name).push(listener);\n    }\n    return this;\n  };\n\n  /**\n   * Subscribes a callback to an event name, removing the it once fired.\n   *\n   * @param {String} name The event name to subscribe the listener to\n   * @param {Function}listener A listener callback to subscribe to the event name\n   * @returns {Events} This Events instance\n   */\n  proto.once = function (name, listener) {\n    var self = this;\n    var interceptor = function () {\n      self.off(name, interceptor);\n      listener.apply(null, arguments);\n    };\n    this.on(name, interceptor);\n    return this;\n  };\n\n  /**\n   * Subscribes a callback to all events, regardless of name.\n   *\n   * @param {Function} listener A listener callback to subscribe for any event name\n   * @returns {Events} This Events instance\n   */\n  proto.onAny = function (listener) {\n    this._any.push(listener);\n    return this;\n  };\n\n  /**\n   * Unsubscribes a callback to an event name.\n   *\n   * @param {String} name The event name to unsubscribe the listener from\n   * @param {Function} listener The listener callback to unsubscribe from the event name\n   * @returns {Events} This Events instance\n   */\n  proto.off = function (name, listener) {\n    var all = this._events[name];\n    if (all) {\n      var i = $.inArray(listener, all);\n      if (i >= 0) {\n        all.splice(i, 1);\n      }\n      if (all.length === 0) {\n        delete this._events[name];\n      }\n    }\n    return this;\n  };\n\n  /**\n   * Unsubscribes all callbacks from an event name, or unsubscribes all event-name-specific listeners\n   * if no name if given.\n   *\n   * @param {String} [name] The event name to unsubscribe all listeners from\n   * @returns {Events} This Events instance\n   */\n  proto.offAll = function (name) {\n    if (name) {\n      delete this._events[name];\n    } else {\n      this._events = {};\n    }\n    return this;\n  };\n\n  /**\n   * Unsubscribes a callback from the set of 'any' event listeners.\n   *\n   * @param {Function} listener A listener callback to unsubscribe from any event name\n   * @returns {Events} This Events instance\n   */\n  proto.offAny = function (listener) {\n    var any = this._any;\n    var i = $.inArray(listener, any);\n    if (i >= 0) {\n      any.splice(i, 1);\n    }\n    return this;\n  };\n\n  /**\n   * Emits an event on this bus, firing listeners by name as well as all 'any' listeners. Arguments following the\n   * name parameter are captured and passed to listeners.  The last argument received by all listeners after the\n   * unpacked arguments array will be the fired event object itself, which can be useful for reacting to event\n   * metadata (e.g. the bus's namespace).\n   *\n   * @param {String} name The name of event to emit\n   * @param {Array.<String>} args 0 or more additional data arguments to deliver with the event\n   * @returns {Events} This Events instance\n   */\n  proto.emit = function (name) {\n    return this._emitEvent(this._event.apply(this, arguments));\n  };\n\n  /**\n   * Creates an opaque event object from an argument list containing at least a name, and optionally additional\n   * event payload arguments.\n   *\n   * @param {String} name The name of event to emit\n   * @param {Array.<String>} args 0 or more additional data arguments to deliver with the event\n   * @returns {Object} A new event object\n   * @private\n   */\n  proto._event = function (name) {\n    return {\n      name: name,\n      args: [].slice.call(arguments, 1),\n      attrs: {},\n      source: {\n        key: this._key,\n        origin: this._origin\n      }\n    };\n  };\n\n  /**\n   * Emits a previously-constructed event object to all listeners.\n   *\n   * @param {Object} event The event object to emit\n   * @param {String} event.name The name of the event\n   * @param {Object} event.source Metadata about the original source of the event, containing key and origin\n   * @param {Array} event.args The args passed to emit, to be delivered to listeners\n   * @returns {Events} This Events instance\n   * @private\n   */\n  proto._emitEvent = function (event) {\n    var args = event.args.concat(event);\n    fire(this._listeners(event.name), args);\n    fire(this._any, [event.name].concat(args));\n    return this;\n  };\n\n  /**\n   * Returns an array of listeners by event name, creating a new name array if none are found.\n   *\n   * @param {String} name The event name for which listeners should be returned\n   * @returns {Array} An array of listeners; empty if none are registered\n   * @private\n   */\n  proto._listeners = function (name) {\n    return this._events[name] = this._events[name] || [];\n  };\n\n  // Internal helper for firing an event to an array of listeners\n  function fire(listeners, args) {\n    for (var i = 0; i < listeners.length; ++i) {\n      try {\n        listeners[i].apply(null, args);\n      } catch (e) {\n        log(e.stack || e.message || e);\n      }\n    }\n  }\n\nexport default {Events: Events}","import base64 from './base64';\n\nfunction parseJwtIssuer(jwt) {\n    return parseJwtClaims(jwt)['iss'];\n}\n\nfunction parseJwtClaims(jwt) {\n\n    if (null === jwt || '' === jwt) {\n        throw('Invalid JWT: must be neither null nor empty-string.');\n    }\n\n    var firstPeriodIndex = jwt.indexOf('.');\n    var secondPeriodIndex = jwt.indexOf('.', firstPeriodIndex + 1);\n\n    if (firstPeriodIndex < 0 || secondPeriodIndex <= firstPeriodIndex) {\n        throw('Invalid JWT: must contain 2 period (\".\") characters.');\n    }\n\n    var encodedClaims = jwt.substring(firstPeriodIndex + 1, secondPeriodIndex);\n\n    if (null === encodedClaims || '' === encodedClaims) {\n        throw('Invalid JWT: encoded claims must be neither null nor empty-string.');\n    }\n\n    var claimsString = base64.decode.call(window, encodedClaims);\n    return JSON.parse(claimsString);\n}\n\nfunction isJwtExpired(jwtString, skew){\n    if(skew === undefined){\n        skew = 60; // give a minute of leeway to allow clock skew\n    }\n    var claims = parseJwtClaims(jwtString),\n    expires = 0,\n    now = Math.floor(Date.now() / 1000); // UTC timestamp now\n\n    if(claims && claims.exp){\n        expires = claims.exp;\n    }\n\n    if( (expires - now) < skew){\n        return true;\n    }\n\n    return false;\n\n}\n\n\nexport default {\n    parseJwtIssuer,\n    parseJwtClaims,\n    isJwtExpired\n}","import base64 from './base64';\nimport uri from './uri';\n/**\n* These are passed into the main host create statement and can override\n* any options inside the velocity template.\n* Additionally these are accessed by the js inside the client iframe to check if we are in a dialog.\n*/\n\nexport default {\n    /**\n    * Encode options for transport\n    */\n    encode: function(options){\n        if(options){\n            var str = JSON.stringify(options);\n            return base64.encode.call(window, str);\n        }\n    },\n    /**\n    * return ui params from a Url\n    **/\n    fromUrl: function(url){\n        var params = new uri.init(url).getQueryParamValue('ui-params');\n        return this.decode(params);\n    },\n    /**\n    * returns ui params from window.name\n    */\n    fromWindowName: function(w, param){\n        w = w || window;\n        var decoded = this.decode(w.name);\n\n        if(!param){\n            return decoded;\n        }\n        return (decoded) ? decoded[param] : undefined;\n    },\n    /**\n    * Decode a base64 encoded json string containing ui params\n    */\n    decode: function(params){\n        var obj = {};\n        if(params && params.length > 0){\n            try {\n                obj = JSON.parse(base64.decode.call(window, params));\n            } catch(e) {\n                if(console && console.log){\n                    console.log('Cannot decode passed ui params', params);\n                }\n            }\n        }\n        return obj;\n    }\n};","import Uri from 'jsuri';\n\nexport default {init: Uri}","import events from './events';\nimport jwt from './jwt';\nimport uri from './uri';\nimport uiParams from './ui-params';\nimport util from '../host/util';\n\n  // Capture some common values and symbol aliases\n  var count = 0;\n\n  /**\n   * Sets up cross-iframe remote procedure calls.\n   * If this is called from a parent window, iframe is created and an RPC interface for communicating with it is set up.\n   * If this is called from within the iframe, an RPC interface for communicating with the parent is set up.\n   *\n   * Calling a remote function is done with the signature:\n   *     fn(data..., doneCallback, failCallback)\n   * doneCallback is called after the remote function executed successfully.\n   * failCallback is called after the remote function throws an exception.\n   * doneCallback and failCallback are optional.\n   *\n   * @param {Object} $ jquery or jquery-like utility\n   * @param {Object} config Configuration parameters\n   * @param {String} config.remoteKey The remote peer's add-on key (host only)\n   * @param {String} config.remote The src of remote iframe (host only)\n   * @param {String} config.container The id of element to which the generated iframe is appended (host only)\n   * @param {Object} config.props Additional attributes to add to iframe element (host only)\n   * @param {String} config.channel Channel (host only); deprecated\n   * @param {Object} bindings RPC method stubs and implementations\n   * @param {Object} bindings.local Local function implementations - functions that exist in the current context.\n   *    XdmRpc exposes these functions so that they can be invoked by code running in the other side of the iframe.\n   * @param {Array} bindings.remote Names of functions which exist on the other side of the iframe.\n   *    XdmRpc creates stubs to these functions that can be invoked from the current page.\n   * @returns XdmRpc instance\n   * @constructor\n   */\n  function XdmRpc($, config, bindings) {\n\n    var self, id, target, remoteOrigin, channel, mixin,\n        localKey, remoteKey, addonKey,\n        w = window,\n        loc = w.location.toString(),\n        locals = bindings.local || {},\n        remotes = bindings.remote || [],\n        localOrigin = getBaseUrl(loc);\n\n    // A hub through which all async callbacks for remote requests are parked until invoked from a response\n    var nexus = function () {\n      var callbacks = {};\n      return {\n        // Registers a callback of a given type by uid\n        add: function (uid, done, fail) {\n          callbacks[uid] = {\n            done: done || null,\n            fail: fail || null,\n            async: !!done\n          };\n        },\n        // Invokes callbacks for a response of a given type by uid if registered, then removes all handlers for the uid\n        invoke: function (type, uid, arg) {\n          var handled;\n          if (callbacks[uid]) {\n            if (callbacks[uid][type]) {\n              // If the intended callback exists, invoke it and mark the response as handled\n              callbacks[uid][type](arg);\n              handled = true;\n            } else {\n              // Only mark other calls as handled if they weren't expecting a callback and didn't fail\n              handled = !callbacks[uid].async && type !== 'fail';\n            }\n            delete callbacks[uid];\n          }\n          return handled;\n        }\n      };\n    }();\n\n    // Use the config and enviroment to construct the core of the new XdmRpc instance.\n    //\n    // Note: The xdm_e|c|p variables that appear in an iframe URL are used to pass message to the XdmRpc bridge\n    // when running inside an add-on iframe.  Their names are holdovers from easyXDM, which was used prior\n    // to building this proprietary library (which was done both to greatly reduce the total amount of JS\n    // needed to drive the postMessage-based RPC communication, and to allow us to extend its capabilities).\n    //\n    // AC-451 describes how we can reduce/improve these (and other) iframe url parameters, but until that is\n    // addressed, here's a brief description of each:\n    //\n    //  - xdm_e contains the base url of the host app; it's presence indicates that the XdmRpc is running in\n    //    an add-on iframe\n    //  - xdm_c contains a unique channel name; this is a holdover from easyXDM that was used to distinguish\n    //    postMessage events between multiple iframes with identical xdm_e values, though this may now be\n    //    redundant with the current internal implementation of the XdmRpc and should be considered for removal\n    if (!/xdm_e/.test(loc)) {\n      // Host-side constructor branch\n\n      // if there is already an iframe created. Destroy it. It's an old version.\n\n      $(document.getElementById(config.container)).find('iframe').trigger('ra.iframe.destroy');\n\n      var iframe = createIframe(config);\n      target = iframe.contentWindow;\n      localKey = param(config.remote, 'oauth_consumer_key') || param(config.remote, 'jwt');\n      remoteKey = config.remoteKey;\n      addonKey = remoteKey;\n      remoteOrigin = getBaseUrl(config.remote).toLowerCase();\n      channel = config.channel;\n      // Define the host-side mixin\n      mixin = {\n        isHost: true,\n        iframe: iframe,\n        uiParams: config.uiParams,\n        destroy: function () {\n          window.clearTimeout(self.timeout); //clear the iframe load time.\n          // Unbind postMessage handler when destroyed\n          unbind();\n          // Then remove the iframe, if it still exists\n          if (self.iframe) {\n            $(self.iframe).remove();\n            delete self.iframe;\n          }\n        },\n        isActive: function () {\n          // Host-side instances are only active as long as the iframe they communicate with still exists in the DOM\n          return $.contains(document.documentElement, self.iframe);\n        }\n      };\n      $(iframe).on('ra.iframe.destroy', mixin.destroy);\n    } else {\n      // Add-on-side constructor branch\n      target = w.parent;\n      localKey = 'local'; // Would be better to make this the add-on key, but it's not readily available at this time\n\n      // identify the add-on by unique key: first try JWT issuer claim and fall back to OAuth1 consumer key\n      var jwtParam = param(loc, 'jwt');\n      remoteKey = jwtParam ? jwt.parseJwtIssuer(jwtParam) : param(loc, 'oauth_consumer_key');\n\n      // if the authentication method is 'none' then it is valid to have no jwt and no oauth in the url\n      // but equally we don't trust this iframe as far as we can throw it, so assign it a random id\n      // in order to prevent it from talking to any other iframe\n      if (null === remoteKey) {\n          remoteKey = Math.random(); // unpredictable and unsecured, like an oauth consumer key\n      }\n\n      addonKey = localKey;\n      remoteOrigin = param(loc, 'xdm_e').toLowerCase();\n      channel = param(loc, 'xdm_c');\n      // Define the add-on-side mixin\n      mixin = {\n        isHost: false,\n        isActive: function () {\n          // Add-on-side instances are always active, as they must always have a parent window peer\n          return true;\n        }\n      };\n    }\n\n    id = addonKey + '|' + (count += 1);\n\n    // Create the actual XdmRpc instance, and apply the context-sensitive mixin\n    self = $.extend({\n      id: id,\n      remoteOrigin: remoteOrigin,\n      channel: channel,\n      addonKey: addonKey\n    }, mixin);\n\n    // Sends a message of a specific type to the remote peer via a post-message event\n    function send(sid, type, message) {\n      try {\n        target.postMessage(JSON.stringify({\n          c: channel,\n          i: sid,\n          t: type,\n          m: message\n        }), remoteOrigin);\n      } catch (ex) {\n        log(errmsg(ex));\n      }\n    }\n\n    // Sends a request with a specific remote method name, args, and optional callbacks\n    function sendRequest(methodName, args, done, fail) {\n      // Generate a random ID for this remote invocation\n      var sid = Math.floor(Math.random() * 1000000000).toString(16);\n      // Register any callbacks with the nexus so they can be invoked when a response is received\n      nexus.add(sid, done, fail);\n      // Send a request to the remote, where:\n      //  - n is the name of the remote function\n      //  - a is an array of the (hopefully) serializable, non-callback arguments to this method\n      send(sid, 'request', {n: methodName, a: args});\n    }\n\n    function sendDone(sid, message) {\n      send(sid, 'done', message);\n    }\n\n    function sendFail(sid, message) {\n      send(sid, 'fail', message);\n    }\n\n    // Handles an normalized, incoming post-message event\n    function receive(e) {\n      try {\n        // Extract message payload from the event\n        var payload = JSON.parse(e.data),\n            pid = payload.i, pchannel = payload.c, ptype = payload.t, pmessage = payload.m;\n\n        // if the iframe has potentially been reloaded. re-attach the source contentWindow object\n        if (e.source !== target && e.origin.toLowerCase() === remoteOrigin && pchannel === channel) {\n          target = e.source;\n        }\n\n        // If the payload doesn't match our expected event signature, assume its not part of the xdm-rpc protocol\n        if (e.source !== target || e.origin.toLowerCase() !== remoteOrigin || pchannel !== channel){\n          return;\n        }\n\n        if (ptype === 'request') {\n          // If the payload type is request, this is an incoming method invocation\n          var name = pmessage.n, args = pmessage.a,\n              local = locals[name], done, fail, async;\n          if (local) {\n            // The message name matches a locally defined RPC method, so inspect and invoke it according\n            // Create responders for each response type\n            done = function (message) { sendDone(pid, message); };\n            fail = function (message) { sendFail(pid, message); };\n            // The local method is considered async if it accepts more arguments than the message has sent;\n            // the additional arguments are filled in with the above async responder callbacks;\n            // TODO: consider specifying args somehow in the remote stubs so that non-callback args can be\n            //       verified before sending a request to fail fast at the callsite\n            async = (args ? args.length : 0) < local.length;\n            var context = locals;\n            if(self.isHost === true){\n                context = self;\n                if(context.analytics){\n                  context.analytics.trackBridgeMethod(name);\n                }\n            } else {\n              context.isHost = false;\n            }\n            try {\n              if (async) {\n                // If async, apply the method with the responders added to the args list\n                local.apply(context, args.concat([done, fail]));\n              } else {\n                // Otherwise, immediately respond with the result\n                done(local.apply(context, args));\n              }\n            } catch (ex) {\n              // If the invocation threw an error, invoke the fail responder callback with it\n              fail(errmsg(ex));\n              logError(ex);\n            }\n          } else {\n            // No such local rpc method name found\n            debug('Unhandled request:', payload);\n          }\n        } else if (ptype === 'done' || ptype === 'fail') {\n          // The payload is of a response type, so try to invoke the appropriate callback via the nexus registry\n          if (!nexus.invoke(ptype, pid, pmessage)) {\n            // The nexus didn't find an appropriate reponse callback to invoke\n            debug('Unhandled response:', ptype, pid, pmessage);\n          }\n        }\n      } catch (ex) {\n        log(errmsg(ex));\n      }\n    }\n\n    // Creates a bridging invocation function for a remote method\n    function bridge(methodName) {\n      // Add a method to this instance that will convert from 'rpc.method(args..., done?, fail?)'-style\n      // invocations to a postMessage event via the 'send' function\n      return function () {\n        var args = [].slice.call(arguments), done, fail;\n        // Pops the last arg off the args list if it's a function\n        function popFn() {\n          if ($.isFunction(args[args.length - 1])) {\n            return args.pop();\n          }\n        }\n        // Remove done/fail callbacks from the args list\n        fail = popFn();\n        done = popFn();\n        if (!done) {\n          // Set the done cb to the value of the fail cb if only one callback fn was given\n          done = fail;\n          fail = undefined;\n        }\n        sendRequest(methodName, args, done, fail);\n      };\n    }\n\n    // For each remote method, generate a like-named interceptor on this instance that converts invocations to\n    // post-message request events, tracking async callbacks as necessary.\n    $.each(remotes, function (methodName, v) {\n      // If remotes were specified as an array rather than a map, promote v to methodName\n      if (typeof methodName === 'number') methodName = v;\n      self[methodName] = bridge(methodName);\n    });\n\n    // Create and attach a local event emitter for bridged pub/sub\n    var bus = self.events = new events.Events(localKey, localOrigin);\n    // Attach an any-listener to forward all locally-originating events to the remote peer\n    bus.onAny(function () {\n      // The actual event object is the last argument passed to any listener\n      var event = arguments[arguments.length - 1];\n      var trace = event.trace = event.trace || {};\n      var traceKey = self.id + '|xdm';\n      if ((self.isHost && !trace[traceKey] && event.source.channel !== self.id)\n          || (!self.isHost && event.source.key === localKey)) {\n        // Only forward an event once in this listener\n        trace[traceKey] = true;\n        // Clone the event and forward without tracing info, to avoid leaking host-side iframe topology to add-ons\n        event = $.extend({}, event);\n        delete event.trace;\n        debug('Forwarding ' + (self.isHost ? 'host' : 'addon') + ' event:', event);\n        sendRequest('_event', [event]);\n      }\n    });\n    // Define our own reserved local to receive remote events\n    locals._event = function (event) {\n      // Reset/ignore any tracing info that may have come across the bridge\n      delete event.trace;\n      if (this.isHost) {\n        // When the running on the host-side, forcibly reset the event's key and origin fields, to prevent spoofing by\n        // untrusted add-ons; also include the host-side XdmRpc instance id to tag the event with this particular\n        // instance of the host/add-on relationship\n        event.source = {\n          channel: this.id || id, // Note: the term channel here != the deprecated xdm channel param\n          key: this.addonKey,\n          origin: this.remoteOrigin || remoteOrigin\n        };\n      }\n      debug('Receiving as ' + (this.isHost ? 'host' : 'addon') + ' event:', event);\n      // Emit the event on the local bus\n      bus._emitEvent(event);\n    };\n\n    // Handles incoming postMessages from this XdmRpc instance's remote peer\n    function postMessageHandler(e) {\n      if (self.isActive()) {\n        // Normalize and forward the event message to the receiver logic\n        receive(e.originalEvent ? e.originalEvent : e);\n      } else {\n        // If inactive (due to the iframe element having disappeared from the DOM), force cleanup of this callback\n        unbind();\n      }\n    }\n\n    // Starts listening for window messaging events\n    function bind() {\n      $(window).bind('message', postMessageHandler);\n    }\n\n    // Stops listening for window messaging events\n    function unbind() {\n      $(window).unbind('message', postMessageHandler);\n    }\n\n    // Crudely extracts a query param value from a url by name\n    function param(url, name) {\n      return new uri.init(url).getQueryParamValue(name);\n    }\n\n    // Determines a base url consisting of protocol+domain+port from a given url string\n    function getBaseUrl(url) {\n      return new uri.init(url).origin();\n    }\n\n    // Appends a map of query parameters to a base url\n    function toUrl(base, params) {\n      var url = new uri.init(base);\n      $.each(params, function (k, v) {\n        url.addQueryParam(k,v);\n      });\n      return url.toString();\n    }\n\n    // Creates an iframe element from a config option consisting of the following values:\n    //  - container:  the parent element of the new iframe\n    //  - remote:     the src url of the new iframe\n    //  - props:      a map of additional HTML attributes for the new iframe\n    //  - channel:    deprecated\n    function createIframe(config) {\n      if(!config.container){\n        throw new Error('config.container must be defined');\n      }\n      var iframe = document.createElement('iframe'),\n        id = 'easyXDM_' + config.container + '_provider',\n        windowName = \"\";\n\n      if(config.uiParams){\n        windowName = uiParams.encode(config.uiParams);\n      }\n      $.extend(iframe, {id: id, name: windowName, frameBorder: '0'}, config.props);\n      //$.extend will not add the attribute rel.\n      iframe.setAttribute('rel', 'nofollow');\n      $(document.getElementById(config.container)).append(iframe);\n      $(iframe).trigger(\"ra.iframe.create\");\n      iframe.src = config.remote;\n      return iframe;\n    }\n\n    function errmsg(ex) {\n      return ex.message || ex.toString();\n    }\n\n    function debug() {\n      if (XdmRpc.debug) log.apply(w, ['DEBUG:'].concat([].slice.call(arguments)));\n    }\n\n    function log() {\n      var log = $.log || (w.AJS && w.AJS.log);\n      if (log) log.apply(w, arguments);\n    }\n\n    function logError() {\n      // $.error seems to do the same thing as $.log in client console\n      var error = (w.AJS && w.AJS.error);\n      if (error) error.apply(w, arguments);\n    }\n\n    // Immediately start listening for events\n    bind();\n\n    return self;\n  }\n\n//  XdmRpc.debug = true;\n\nexport default XdmRpc;\n\n","function escapeSelector(s) {\n    if (!s) {\n        throw new Error('No selector to escape');\n    }\n    return s.replace(/[!\"#$%&'()*+,.\\/:;<=>?@[\\\\\\]^`{|}~]/g, '\\\\$&');\n}\n\nexport default {escapeSelector}","import util from './util';\nimport $ from './dollar';\nimport _events from '../common/events';\nimport base64 from '../common/base64';\nimport uri from '../common/uri';\nimport uiParams from '../common/ui-params';\nimport xdm from '../common/xdm-rpc';\nimport rpc from './rpc';\nimport events from './events';\nimport env from './env';\n\nimport messages from './messages';\nimport dialog from './dialog';\nimport inlineDialog from './inline-dialog';\nimport resize_listener from './resize_listener';\n// pre-populate all the old core modules for the old AP.require syntax.\n\nvar modules = {\n  '_util': {exports: util},\n  '_dollar': {exports: $},\n  '_events': {exports: _events},\n  '_base64': {exports:  base64},\n  '_uri': {exports: uri},\n  '_ui-params': {exports: uiParams},\n  '_xdm': {exports: xdm},\n  '_rpc': {exports: rpc},\n  'events': {exports: events},\n  'env': {exports: env},\n  'messages': {exports: messages},\n  'dialog': {exports: dialog},\n  'inline-dialog': {exports: inlineDialog},\n  '_resize_listener': {exports: resize_listener}\n};\n\nfunction reqAll(deps, callback) {\n  var mods = [], i = 0, len = deps.length;\n  function addOne(mod) {\n    mods.push(mod);\n    if (mods.length === len) {\n      var exports = [], i = 0;\n      for (; i < len; i += 1) {\n        exports[i] = mods[i].exports;\n      }\n      if (callback) callback.apply(window, exports);\n    }\n  }\n  if (deps && deps.length > 0) {\n    for (; i < len; i += 1) {\n      reqOne(deps[i], addOne);\n    }\n  }\n  else {\n    if (callback) callback();\n  }\n}\n\nfunction reqOne(name, callback) {\n  // naive impl that assumes all modules are already loaded\n  callback(getOrCreate(name));\n}\n\nfunction getOrCreate(name) {\n  return modules[name] = modules[name] || {\n    name: name,\n    exports: function () {\n      function exports() {\n        var target = exports.__target__;\n        if (target) {\n          return target.apply(window, arguments);\n        }\n      }\n      return exports;\n    }()\n  };\n}\n\n// define(name, objOrFn)\n// define(name, deps, fn(dep1, dep2, ...))\nexport default {\n  define: function (name, deps, exports) {\n    var mod = getOrCreate(name),\n        factory;\n    if (!exports) {\n      exports = deps;\n      deps = [];\n    }\n    if (exports) {\n      factory = typeof exports !== 'function' ? function () { return exports; } : exports;\n      reqAll(deps, function () {\n        var exports = factory.apply(window, arguments);\n        if (exports) {\n          if (typeof exports === 'function') {\n            mod.exports.__target__ = exports;\n          }\n          for (var k in exports) {\n            if (exports.hasOwnProperty(k)) {\n              mod.exports[k] = exports[k];\n            }\n          }\n        }\n      });\n    }\n  },\n  require: function(deps, callback) {\n\n    reqAll(typeof deps === 'string' ? [deps] : deps, callback);\n  }\n};\n","import $ from './dollar';\nimport rpc from './rpc';\nimport UiParams from '../common/ui-params';\nimport Uri from '../common/uri';\n\n/**\n * The Dialog module provides a mechanism for launching an add-on's modules as modal dialogs from within an add-on's iframe.\n * A modal dialog displays information without requiring the user to leave the current page.\n * The dialog is opened over the entire window, rather than within the iframe itself.\n * ###Styling your dialog to look like a standard Atlassian dialog\n * By default the dialog iframe is undecorated. It's up to the developer to style the dialog.\n * <img src=\"../assets/images/connectdialogchromelessexample.jpeg\" width=\"100%\" />\n *\n * In order to maintain a consistent look and feel between the host application and the add-on,\n * we encourage add-on developers to style their dialogs to match Atlassian's Design Guidelines for modal dialogs.\n * To do that, you'll need to add the AUI styles to your dialog.\n *\n * For more information, read about the Atlassian User Interface [dialog component](https://docs.atlassian.com/aui/latest/docs/dialog.html).\n * @exports Dialog\n */\n\nvar uiParams = UiParams.fromUrl(window.location.toString()),\n  isDialog = Boolean(uiParams.dlg) || Boolean(uiParams.isDialog),\n  exports,\n  url = new Uri.init(window.location.toString());\n\n// if it has been set to a dialog on the server.\nif(url.getQueryParamValue('dialog') === '1'){\n  isDialog = true;\n}\n\nrpc.extend(function (remote) {\n\n  // dialog-related sub-api for use when the remote plugin is running as the content of a host dialog\n\n  var listeners = {};\n\n  exports = {\n    /**\n    * Creates a dialog for a web-item or page module key.\n    * @name Dialog\n    * @class\n    * @property {function} on Takes parameters event name ({String}) and callback ({Function})\n    * @param {DialogOptions} options configuration object of dialog options.\n    * @example\n    * AP.require('dialog', function(dialog){\n    *   dialog.create({\n    *     key: 'my-module-key',\n    *     width: '500px',\n    *     height: '200px',\n    *     chrome: true\n    *   }).on('close', callbackFunc);\n    * });\n    *\n    * @return {Dialog} Dialog object allowing for callback registrations\n    */\n    create: function(options) {\n      /**\n      * @name DialogOptions\n      * @class\n      * @property {String}        key         The module key of the page you want to open as a dialog\n      * @property {String}        size        Opens the dialog at a preset size: small, medium, large, x-large or maximum (full screen).\n      * @property {Number|String} width       overrides size, define the width as a percentage (append a % to the number) or pixels.\n      * @property {Number|String} height      overrides size, define the height as a percentage (append a % to the number) or pixels.\n      * @property {Boolean}       chrome      (optional) opens the dialog with heading and buttons.\n      * @property {String}        header      (optional) text to display in the header if opening a dialog with chrome.\n      * @property {String}        submitText  (optional) text for the submit button if opening a dialog with chrome.\n      * @property {String}        cancelText  (optional) text for the cancel button if opening a dialog with chrome.\n      */\n      remote.createDialog(options);\n      return {\n        on: function (event, callback) {\n          // HACK: Note this is a 'once' as it's assumed the only event is 'close', and close is only fired\n          // once per dialog. If we changed this to 'on', then it would be fired when *any* dialog is closed,\n          // meaning that if say two dialog were opened, closed, opened, then closed, then the callback\n          // registered for the first dialog would be issued when the second was closed.\n          remote.events.once('dialog.' + event, callback);\n        }\n      };\n    },\n    /**\n    * Closes the currently open dialog. Optionally pass data to listeners of the `dialog.close` event.\n    * This will only close a dialog that has been opened by your add-on.\n    * You can register for close events using the `dialog.close` event and the [events module](module-Events.html)\n    * @param {Object} data An object to be emitted on dialog close.\n    * @noDemo\n    * @example\n    * AP.require('dialog', function(dialog){\n    *   dialog.close({foo: 'bar'});\n    * });\n    */\n    close: function(data) {\n      remote.events.emit('dialog.close', data);\n      remote.closeDialog();\n    },\n\n    isDialog: isDialog,\n\n    /**\n    * register callbacks responding to messages from the host dialog, such as 'submit' or 'cancel'\n    * @param String button either 'cancel' or 'submit'\n    * @param Function callback function\n    * @deprecated\n    */\n    onDialogMessage: function (message, listener) {\n      this.getButton(message).bind(listener);\n    },\n    /**\n    * Returns the button that was requested (either cancel or submit)\n    * @returns {DialogButton}\n    * @noDemo\n    * @example\n    * AP.require('dialog', function(dialog){\n    *   dialog.getButton('submit');\n    * });\n    */\n    getButton: function (name) {\n      /**\n      * @class DialogButton\n      * @description A dialog button that can be controlled with javascript\n      */\n      return {\n        name: name,\n\n        /**\n        * Sets the button state to enabled\n        * @memberOf DialogButton\n        * @noDemo\n        * @example\n        * AP.require('dialog', function(dialog){\n        *   dialog.getButton('submit').enable();\n        * });\n        */\n        enable: function () {\n          remote.setDialogButtonEnabled(name, true);\n        },\n        /**\n        * Sets the button state to disabled\n        * @memberOf DialogButton\n        * @noDemo\n        * @example\n        * AP.require('dialog', function(dialog){\n        *   dialog.getButton('submit').disable();\n        * });\n        */\n        disable: function () {\n          remote.setDialogButtonEnabled(name, false);\n        },\n        /**\n        * Toggle the button state between enabled and disabled.\n        * @memberOf DialogButton\n        * @noDemo\n        * @example\n        * AP.require('dialog', function(dialog){\n        *   dialog.getButton('submit').toggle();\n        * });\n        */\n        toggle: function () {\n          var self = this;\n          self.isEnabled(function (enabled) {\n            self[enabled ? 'disable' : 'enable'](name);\n          });\n        },\n        /**\n        * Query a button for it's current state.\n        * @memberOf DialogButton\n        * @param {Function} callback function to receive the button state.\n        * @noDemo\n        * @example\n        * AP.require('dialog', function(dialog){\n        *   dialog.getButton('submit').isEnabled(function(enabled){\n        *     if(enabled){\n        *       //button is enabled\n        *     }\n        *   });\n        * });\n        */\n        isEnabled: function (callback) {\n          remote.isDialogButtonEnabled(name, callback);\n        },\n        /**\n        * Registers a function to be called when the button is clicked.\n        * @memberOf DialogButton\n        * @param {Function} callback function to be triggered on click or programatically.\n        * @noDemo\n        * @example\n        * AP.require('dialog', function(dialog){\n        *   dialog.getButton('submit').bind(function(){\n        *     alert('clicked!');\n        *   });\n        * });\n        */\n        bind: function (listener) {\n          remote.dialogListenerBound();\n          var list = listeners[name];\n          if (!list) {\n            list = listeners[name] = [];\n          }\n          list.push(listener);\n        },\n        /**\n        * Trigger a callback bound to a button.\n        * @memberOf DialogButton\n        * @noDemo\n        * @example\n        * AP.require('dialog', function(dialog){\n        *   dialog.getButton('submit').bind(function(){\n        *     alert('clicked!');\n        *   });\n        *   dialog.getButton('submit').trigger();\n        * });\n        */\n        trigger: function () {\n          var self = this,\n              cont = true,\n              result = true,\n              list = listeners[name];\n          $.each(list, function (i, listener) {\n            result = listener.call(self, {\n              button: self,\n              stopPropagation: function () { cont = false; }\n            });\n            return cont;\n          });\n          return !!result;\n        }\n      };\n    }\n\n  };\n\n  return {\n\n    internals: {\n\n      // forwards dialog event messages from the host application to locally registered handlers\n      dialogMessage: function (name) {\n        var result = true;\n        try {\n          if (isDialog) {\n            result = exports.getButton(name).trigger();\n          }\n          else {\n            $.handleError('Received unexpected dialog button event from host:', name);\n          }\n        }\n        catch (e) {\n          $.handleError(e);\n        }\n        return result;\n      }\n\n    },\n\n    stubs: [\n      'dialogListenerBound',\n      'setDialogButtonEnabled',\n      'isDialogButtonEnabled',\n      'createDialog',\n      'closeDialog'\n      ],\n\n      init: function() {\n        if(isDialog) {\n          window.addEventListener('keydown', function (event) {\n            if (event.keyCode === 27) {\n              exports.close();\n            }\n          });\n        }\n      }\n\n  };\n\n});\n\nexport default exports;","import util from './util';\n\nvar each = util.each,\n    extend = util.extend,\n    document = window.document;\n\nfunction $(sel, context) {\n\n  context = context || document;\n\n  var els = [];\n  if (sel) {\n    if (typeof sel === 'string') {\n      var results = context.querySelectorAll(sel);\n      each(results, function (i, v) { els.push(v); });\n    }\n    else if (sel.nodeType === 1) {\n      els.push(sel);\n    }\n    else if (sel === window) {\n      els.push(sel);\n    }\n  }\n\n  extend(els, {\n    each: function (it) {\n      each(this, it);\n      return this;\n    },\n    bind: function (name, callback) {\n      this.each(function (i, el) {\n        util.bind(el, name, callback);\n      });\n    },\n    attr: function (k) {\n      var v;\n      this.each(function (i, el) {\n        v = el[k] || (el.getAttribute && el.getAttribute(k));\n        return !v;\n      });\n      return v;\n    },\n    removeClass: function (className) {\n      return this.each(function (i, el) {\n        if (el.className) {\n          el.className = el.className.replace(new RegExp('(^|\\\\s)' + className + '(\\\\s|$)'), ' ');\n        }\n      });\n    },\n    html: function (html) {\n      return this.each(function (i, el) {\n        el.innerHTML = html;\n      });\n    },\n    append: function (spec) {\n      return this.each(function (i, to) {\n        var el = context.createElement(spec.tag);\n        each(spec, function (k, v) {\n          if (k === '$text') {\n            if (el.styleSheet) { // style tags in ie\n              el.styleSheet.cssText = v;\n            }\n            else {\n              el.appendChild(context.createTextNode(v));\n            }\n          }\n          else if (k !== 'tag') {\n            el[k] = v;\n          }\n        });\n        to.appendChild(el);\n      });\n    }\n  });\n\n  return els;\n}\n\nexport default extend($, util);\n","import $ from './dollar';\nimport rpc from './rpc';\nimport UiParams from '../common/ui-params';\n\nvar uiParams = UiParams.fromWindowName(),\n    isInlineDialog = Boolean(uiParams.isInlineDialog),\n    isInlineAddon = Boolean(uiParams.isInlineAddon);\n\nvar apis = rpc.extend(function (remote) {\n\n  return {\n    /**\n    * @exports AP\n    * Utility methods that are available without requiring additional modules.\n    */\n    apis: {\n\n      /**\n      * get the location of the host page\n      *\n      * @param {Function} callback function (location) {...}\n      * @example\n      * AP.getLocation(function(location){\n      *   alert(location);\n      * });\n      */\n      getLocation: function (callback) {\n        remote.getLocation(callback);\n      },\n\n      getUser: function(callback){\n        AP.require(['user'], function(user){\n          if(user && user.getUser){\n            return user.getUser(callback);\n          }\n        });\n      },\n\n      /**\n      * resize this iframe\n      * @method\n      * @param {String} width   the desired width\n      * @param {String} height  the desired height\n      */\n      resize: $.debounce(function (width, height) {\n        var dim = apis.size(width, height, apis.container());\n        remote.resize(dim.w, dim.h);\n      }, 50),\n\n      sizeToParent: $.debounce(function() {\n        remote.sizeToParent();\n      }, 50)\n    }\n\n  };\n\n});\n\nexport default $.extend(apis, {\n\n  meta: function (name) {\n    //IE8 fallback: querySelectorAll will never find nodes by name.\n    if(navigator.userAgent.indexOf('MSIE 8') >= 0){\n      var i,\n      metas = document.getElementsByTagName('meta');\n\n      for (i=0; i<metas.length; i++) {\n        if(metas[i].getAttribute('name') === 'ap-' + name) {\n           return metas[i].getAttribute('content');\n        }\n      }\n    } else {\n      return $('meta[name=\"ap-' + name + '\"]').attr('content');\n    }\n  },\n\n  container: function(){\n    // Look for these two selectors first... you need these to allow for the auto-shrink to work\n    // Otherwise, it'll default to document.body which can't auto-grow or auto-shrink\n    var container = $('.ac-content, #content');\n    return container.length>0 ? container[0]: document.body;\n  },\n\n  localUrl: function (path) {\n    return this.meta('local-base-url') + (path == null ? \"\" : path);\n  },\n\n  size: function (width, height, container) {\n    var w = width == null ? '100%' : width, h, docHeight;\n\n    if(!container){\n      container = this.container();\n    }\n\n    // if it's an inline dialog. 100% won't work. Instead, get the container pixel width.\n    if( (!w || w === \"100%\") && (isInlineAddon || (isInlineDialog && width === '100%'))){\n      w = Math.max(\n        container.scrollWidth,\n        container.offsetWidth,\n        container.clientWidth\n      );\n\n    }\n\n    if (height) {\n      h = height;\n    } else {\n      // Determine height\n      docHeight = Math.max(\n        container.scrollHeight, document.documentElement.scrollHeight,\n        container.offsetHeight, document.documentElement.offsetHeight,\n        container.clientHeight, document.documentElement.clientHeight\n      );\n\n      if(container === document.body){\n        h = docHeight;\n      } else {\n        // Started with http://james.padolsey.com/javascript/get-document-height-cross-browser/\n        // to determine page height across browsers. Turns out that in our case, we can get by with\n        // document.body.offsetHeight and document.body.clientHeight. Those two return the proper\n        // height even when the dom shrinks. Tested on Chrome, Safari, IE8/9/10, and Firefox\n        h = Math.max(container.offsetHeight, container.clientHeight);\n        if(h===0){\n            h = docHeight;\n        }\n      }\n    }\n    // we need to return pixel width for inline elements such as dialogs and inline dialogs\n    // as they cannot get height from the parent.\n    return {w: w, h: h};\n  }\n});\n","import $ from './dollar';\nimport rpc from './rpc';\n/**\n* The Events module provides a mechanism for emitting and receiving events.\n* <h3>Basic example</h3>\n* ```\n* //The following will create an alert message every time the event `customEvent` is triggered.\n* AP.require('events', function(events){\n*   events.on('customEvent', function(){\n*       alert('event fired');\n*   });\n*   events.emit('customEvent');\n* });\n* ```\n* @name Events\n* @module\n*/\n\nexport default rpc.extend(function (remote) {\n    // Expose an Events API that delegates the to the underlying XdmRpc events bus; this is necessary since the bus\n    // itself isn't actually created until the XdmRpc object is constructed, which hasn't happened yet at this point;\n    // see the jsdoc in ../_events.js for API docs\n    var apis = {};\n    $.each(['on', 'once', 'onAny', 'off', 'offAll', 'offAny', 'emit'], function (_, name) {\n      apis[name] = function () {\n        var events = remote.events;\n        events[name].apply(events, arguments);\n        return apis;\n      };\n    });\n\n    // TODO: Experimental cross-addon eventing\n    //    // Add additional methods that tag the event as being globally-distributable to all addons.\n    //\n    //    apis.emitGlobal = function (name) {\n    //      return apis.emitWhitelist.apply(apis, [/.*/].concat([].slice.call(arguments, 1)));\n    //    };\n    //\n    //    apis.emitWhitelist = function (regex, name) {\n    //      var events = remote.events;\n    //      var event = events._event.apply(events, arguments);\n    //      event.attrs._acAllow = regex.toString();\n    //      events._emitEvent(event);\n    //      return apis;\n    //    };\n\n    return {\n     /**\n     * Adds a listener for all occurrences of an event of a particular name.\n     * Listener arguments include any arguments passed to `events.emit`, followed by an object describing the complete event information.\n     * @name on\n     * @method\n     * @memberof module:Events#\n     * @param {String} name The event name to subscribe the listener to\n     * @param {Function} listener A listener callback to subscribe to the event name\n     */\n\n    /**\n     * Adds a listener for one occurrence of an event of a particular name.\n     * Listener arguments include any argument passed to `events.emit`, followed by an object describing the complete event information.\n     * @name once\n     * @method\n     * @memberof module:Events#\n     * @param {String} name The event name to subscribe the listener to\n     * @param {Function}listener A listener callback to subscribe to the event name\n     */\n\n    /**\n     * Adds a listener for all occurrences of any event, regardless of name.\n     * Listener arguments begin with the event name, followed by any arguments passed to `events.emit`, followed by an object describing the complete event information.\n     * @name onAny\n     * @method\n     * @memberof module:Events#\n     * @param {Function} listener A listener callback to subscribe for any event name\n     */\n\n    /**\n     * Removes a particular listener for an event.\n     * @name off\n     * @method\n     * @memberof module:Events#\n     * @param {String} name The event name to unsubscribe the listener from\n     * @param {Function} listener The listener callback to unsubscribe from the event name\n     */\n\n    /**\n     * Removes all listeners from an event name, or unsubscribes all event-name-specific listeners\n     * if no name if given.\n     * @name offAll\n     * @method\n     * @memberof module:Events#\n     * @param {String} [name] The event name to unsubscribe all listeners from\n     */\n\n    /**\n     * Removes an `any` event listener.\n     * @name offAny\n     * @method\n     * @memberof module:Events#\n     * @param {Function} listener A listener callback to unsubscribe from any event name\n     */\n\n    /**\n     * Emits an event on this bus, firing listeners by name as well as all 'any' listeners. Arguments following the\n     * name parameter are captured and passed to listeners.\n     * @name emit\n     * @method\n     * @memberof module:Events#\n     * @param {String} name The name of event to emit\n     * @param {String[]} args 0 or more additional data arguments to deliver with the event\n     */\n      apis: apis\n    };\n});\n","import $ from './dollar';\nimport rpc from './rpc';\n\n/**\n * The inline dialog is a wrapper for secondary content/controls to be displayed on user request. Consider this component as displayed in context to the triggering control with the dialog overlaying the page content.\n * A inline dialog should be preferred over a modal dialog when a connection between the action has a clear benefit versus having a lower user focus.\n *\n * For more information, read about the Atlassian User Interface [inline dialog component](https://docs.atlassian.com/aui/latest/docs/inlineDialog.html).\n * @exports inline-dialog\n */\n\nvar exports;\n\nrpc.extend(function (remote) {\n    exports = {\n        /**\n        * Hide the inline dialog that contains your connect add-on.\n        * @noDemo\n        * @example\n        * AP.require('inline-dialog', function(inlineDialog){\n        *   inlineDialog.hide();\n        * });\n        */\n        hide: function () {\n            remote.hideInlineDialog();\n        }\n    };\n    return {\n        stubs: ['hideInlineDialog']\n    }\n});\n\nexport default exports;","import $ from './dollar';\nimport rpc from './rpc';\n\n/**\n* Messages are the primary method for providing system feedback in the product user interface.\n* Messages include notifications of various kinds: alerts, confirmations, notices, warnings, info and errors.\n* For visual examples of each kind please see the [Design guide](https://developer.atlassian.com/design/latest/communicators/messages/).\n* ### Example ###\n* ```\n* AP.require('messages', function(messages){\n*   //create a message\n*   var message = messages.info('plain text title', 'plain text body');\n* });\n* ```\n* @exports messages\n*/\n\nvar messageId = 0;\n\nfunction getMessageId(){\n    messageId++;\n    return 'ap-message-' + messageId;\n}\n\nexport default rpc.extend(function (remote) {\n\n    var apis = {};\n    $.each(['generic', 'error', 'warning', 'success', 'info', 'hint'], function (_, name) {\n        apis[name] = function (title, body, options) {\n            options = options || {};\n            options.id = getMessageId();\n            remote.showMessage(name, title, body, options);\n            return options.id;\n        };\n    });\n\n    /**\n    * clear a message\n    * @name clear\n    * @method\n    * @memberof module:messages#\n    * @param    {String}    id  The id that was returned when the message was created.\n    * @example\n    * AP.require('messages', function(messages){\n    *   //create a message\n    *   var message = messages.info('title', 'body');\n    *   setTimeout(function(){\n    *     messages.clear(message);\n    *   }, 2000);\n    * });\n    */\n\n    apis.clear = function(id){\n        remote.clearMessage(id);\n    }\n\n    return {\n        /**\n        * Show a generic message\n        * @name generic\n        * @method\n        * @memberof module:messages#\n        * @param    {String}            title       Sets the title text of the message.\n        * @param    {String}            body        The main content of the message.\n        * @param    {MessageOptions}    options     Message Options\n        * @returns  {String}    The id to be used when clearing the message\n        * @example\n        * AP.require('messages', function(messages){\n        *   //create a message\n        *   var message = messages.generic('title', 'generic message example');\n        * });\n        */\n\n        /**\n        * Show an error message\n        * @name error\n        * @method\n        * @memberof module:messages#\n        * @param    {String}            title       Sets the title text of the message.\n        * @param    {String}            body        The main content of the message.\n        * @param    {MessageOptions}    options     Message Options\n        * @returns  {String}    The id to be used when clearing the message\n        * @example\n        * AP.require('messages', function(messages){\n        *   //create a message\n        *   var message = messages.error('title', 'error message example');\n        * });\n        */\n\n        /**\n        * Show a warning message\n        * @name warning\n        * @method\n        * @memberof module:messages#\n        * @param    {String}            title       Sets the title text of the message.\n        * @param    {String}            body        The main content of the message.\n        * @param    {MessageOptions}    options     Message Options\n        * @returns  {String}    The id to be used when clearing the message\n        * @example\n        * AP.require('messages', function(messages){\n        *   //create a message\n        *   var message = messages.warning('title', 'warning message example');\n        * });\n        */\n\n        /**\n        * Show a success message\n        * @name success\n        * @method\n        * @memberof module:messages#\n        * @param    {String}            title       Sets the title text of the message.\n        * @param    {String}            body        The main content of the message.\n        * @param    {MessageOptions}    options     Message Options\n        * @returns  {String}    The id to be used when clearing the message\n        * @example\n        * AP.require('messages', function(messages){\n        *   //create a message\n        *   var message = messages.success('title', 'success message example');\n        * });\n        */\n\n        /**\n        * Show an info message\n        * @name info\n        * @method\n        * @memberof module:messages#\n        * @param    {String}            title       Sets the title text of the message.\n        * @param    {String}            body        The main content of the message.\n        * @param    {MessageOptions}    options     Message Options\n        * @returns  {String}    The id to be used when clearing the message\n        * @example\n        * AP.require('messages', function(messages){\n        *   //create a message\n        *   var message = messages.info('title', 'info message example');\n        * });\n        */\n\n        /**\n        * Show a hint message\n        * @name hint\n        * @method\n        * @memberof module:messages#\n        * @param    {String}            title       Sets the title text of the message.\n        * @param    {String}            body        The main content of the message.\n        * @param    {MessageOptions}    options     Message Options\n        * @returns  {String}    The id to be used when clearing the message\n        * @example\n        * AP.require('messages', function(messages){\n        *   //create a message\n        *   var message = messages.hint('title', 'hint message example');\n        * });\n        */\n\n        apis: apis,\n        stubs: ['showMessage', 'clearMessage']\n    };\n});\n\n/**\n* @name MessageOptions\n* @class\n* @property {Boolean}   closeable   Adds a control allowing the user to close the message, removing it from the page.\n* @property {Boolean}   fadeout     Toggles the fade away on the message\n* @property {Number}    delay       Time to wait (in ms) before starting fadeout animation (ignored if fadeout==false)\n* @property {Number}    duration    Fadeout animation duration in milliseconds (ignored if fadeout==false)\n*/","import rpc from './rpc';\nimport events from '../common/dom-events.js';\n'use strict';\n\n/**\n * Allows add-ons to receive whitelisted events from the parent page in the addon iframe.\n */\nexport default rpc.extend(function (remote) {\n    return {\n        init: function () {\n            events.bindListeners(remote.channel, remote.propagateToHost);\n        },\n        internals: {\n            propagateToPlugin: events.receiveEvent\n        },\n        stubs: ['propagateToHost']\n    };\n});","import $ from './dollar';\n\n// Normalize overflow/underflow events across browsers\n// http://www.backalleycoder.com/2013/03/14/oft-overlooked-overflow-and-underflow-events/\nfunction addFlowListener(element, type, fn){\n    var flow = type == 'over';\n    element.addEventListener('OverflowEvent' in window ? 'overflowchanged' : type + 'flow', function(e){\n        if (e.type == (type + 'flow') ||\n            ((e.orient == 0 && e.horizontalOverflow == flow) ||\n                (e.orient == 1 && e.verticalOverflow == flow) ||\n                (e.orient == 2 && e.horizontalOverflow == flow && e.verticalOverflow == flow))) {\n            e.flow = type;\n            return fn.call(this, e);\n        }\n    }, false);\n};\n\n// Adds a resize listener to a DOM element (other within <body>). It first adds a set of invisible\n// 'sensor' divs to the bottom of the selected element. Those sensor divs serve as over/underflow\n// detectors using the addFlowLister. The flowListener triggers the over/underflow within the div\n// which tells us that the element has resized. We compare the previous and current size. If it's\n// changed, we trigger the resize event.\n//\n// This listener is initiated during the page load event in _init.js. The callback function is\n// the actual iframe resize function in env.js.\nfunction addListener(element, fn){\n    var resize = 'onresize' in element;\n    if (!resize && !element._resizeSensor) {\n        $('head').append({tag: 'style', type: 'text/css', $text: '.ac-resize-sensor,.ac-resize-sensor>div {position: absolute;top: 0;left: 0;width: 100%;height: 100%;overflow: hidden;z-index: -1;}'});\n        var sensor = element._resizeSensor = document.createElement('div');\n        sensor.className = 'ac-resize-sensor';\n        sensor.innerHTML = '<div class=\"ac-resize-overflow\"><div></div></div><div class=\"ac-resize-underflow\"><div></div></div>';\n\n        var x = 0, y = 0,\n        first = sensor.firstElementChild.firstChild,\n        last = sensor.lastElementChild.firstChild,\n        matchFlow = function(event){\n            var change = false,\n            width = element.offsetWidth;\n            if (x != width) {\n                first.style.width = width - 1 + 'px';\n                last.style.width = width + 1 + 'px';\n                change = true;\n                x = width;\n            }\n            var height = element.offsetHeight;\n            if (y != height) {\n                first.style.height = height - 1 + 'px';\n                last.style.height = height + 1 + 'px';\n                change = true;\n                y = height;\n            }\n            if (change && event.currentTarget != element) {\n                var event = document.createEvent('Event');\n                event.initEvent('resize', true, true);\n                element.dispatchEvent(event);\n            }\n        };\n\n        if (getComputedStyle(element).position === 'static'){\n            element.style.position = 'relative';\n            element._resizeSensor._resetPosition = true;\n        }\n        addFlowListener(sensor, 'over', matchFlow);\n        addFlowListener(sensor, 'under', matchFlow);\n        addFlowListener(sensor.firstElementChild, 'over', matchFlow);\n        addFlowListener(sensor.lastElementChild, 'under', matchFlow);\n        element.appendChild(sensor);\n        matchFlow({});\n    }\n    var events = element._flowEvents || (element._flowEvents = []);\n    if ($.inArray(fn, events) == -1) events.push(fn);\n    if (!resize) element.addEventListener('resize', fn, false);\n    element.onresize = function(e){\n        $.each(events,function(idx,fn){\n            fn.call(element, e);\n        });\n    };\n};\n\nexport default {\n  addListener: addListener\n};\n","import $ from './dollar';\nimport XdmRpc from '../common/xdm-rpc';\n\nvar each = $.each,\n    extend = $.extend,\n    isFn = $.isFunction,\n    proxy = {},\n    rpc,\n    apis = {},\n    stubs = ['init'],\n    internals = {},\n    inits = [],\n    isInited;\n\nexport default {\n\n  extend: function (config) {\n    if (isFn(config)) config = config(proxy);\n    extend(apis, config.apis);\n    extend(internals, config.internals);\n    stubs = stubs.concat(config.stubs || []);\n    var init = config.init;\n    if (isFn(init)) inits.push(init);\n    return config.apis;\n  },\n\n  // inits the connect add-on on iframe content load\n  init: function (options) {\n    options = options || {};\n    if (!isInited) {\n      // add stubs for each public api\n      each(apis, function (method) { stubs.push(method); });\n      // empty config for add-on-side ctor\n      rpc = this.rpc = new XdmRpc($, {}, {remote: stubs, local: internals});\n      rpc.init();\n      extend(proxy, rpc);\n      each(inits, function (_, init) {\n        try { init(extend({}, options)); }\n        catch (ex) { $.handleError(ex); }\n      });\n      isInited = true;\n    }\n  }\n\n};","// universal iterator utility\nfunction each(o, it) {\n    var l;\n    var k;\n    if (o) {\n        l = o.length;\n        if (l != null && typeof o !== 'function') {\n            k = 0;\n            while (k < l) {\n                if (it.call(o[k], k, o[k]) === false) break;\n                k += 1;\n            }\n        } else {\n            for (k in o) {\n                if (o.hasOwnProperty(k)) {\n                    if (it.call(o[k], k, o[k]) === false) break;\n                }\n            }\n        }\n    }\n}\n\nfunction binder(std, odd) {\n    std += 'EventListener';\n    odd += 'Event';\n    return function (el, e, fn) {\n        if (el[std]) {\n            el[std](e, fn, false);\n        } else if (el[odd]) {\n            el[odd]('on' + e, fn);\n        }\n    };\n}\n\nfunction log() {\n    var console = this.console;\n    if (console && console.log) {\n        var args = [].slice.call(arguments);\n        if (console.log.apply) {\n            console.log.apply(console, args);\n        } else {\n            for (var i = 0, l = args.length; i < l; i += 1) {\n              args[i] = JSON.stringify(args[i]);\n            }\n            console.log(args.join(' '));\n        }\n        return true;\n    }\n}\n\nfunction decodeQueryComponent(encodedURI) {\n    return encodedURI == null ? null : decodeURIComponent(encodedURI.replace(/\\+/g, '%20'));\n}\n\nexport default {\n    each,\n    log,\n    decodeQueryComponent,\n    bind: binder('add', 'attach'),\n    unbind: binder('remove', 'detach'),\n\n    extend: function (dest) {\n        var args = arguments;\n        var srcs = [].slice.call(args, 1, args.length);\n        each(srcs, function (i, src) {\n            each(src, function (k, v) {\n                dest[k] = v;\n            });\n        });\n        return dest;\n    },\n\n    trim: function (s) {\n        return s && s.replace(/^\\s+|\\s+$/g, '');\n    },\n\n    debounce: function (fn, wait) {\n        var timeout;\n        return function () {\n            var ctx = this;\n            var args = [].slice.call(arguments);\n            function later() {\n                timeout = null;\n                fn.apply(ctx, args);\n            }\n            if (timeout) {\n                clearTimeout(timeout);\n            }\n            timeout = setTimeout(later, wait || 50);\n        };\n    },\n\n    inArray: function (value, array, fromIndex) {\n        //optimisation for all browsers after IE8\n        if (Array.prototype.indexOf) {\n          return Array.prototype.indexOf.call(array, value, fromIndex);\n        }\n\n        var k = fromIndex >>> 0, len = array.length >>> 0;\n        for (; k < len; k += 1) {\n            if (array[k] === value) return k;\n        }\n        return -1;\n    },\n\n    isFunction: function (fn) {\n        return typeof fn === 'function';\n    },\n\n    handleError: function (err) {\n        if (!log.apply(this, err && err.message ? [err, err.message] : [err])) {\n            throw err;\n        }\n    }\n}"]}