'use strict';window._AP=window._AP||{};
(function(e){function g(a,c){var b=[],d=0,h=a.length;if(a&&0<a.length)for(;d<h;d+=1){var l=f(a[d]);b.push(l);if(b.length===h){for(var l=[],m=0;m<h;m+=1)l[m]=b[m].exports;c&&c.apply(e,l)}}else c&&c()}function f(a){return b[a]=b[a]||{name:a,exports:function(){function a(){var b=a.__target__;if(b)return b.apply(e,arguments)}return a}()}}var d=e._AP?_AP:e.RA=e.AP={},b={};d.define=function(a,c,b){var d=f(a),h;b||(b=c,c=[]);b&&(h="function"!==typeof b?function(){return b}:b,g(c,function(){var a=h.apply(e,
arguments);if(a){"function"===typeof a&&(d.exports.__target__=a);for(var c in a)a.hasOwnProperty(c)&&(d.exports[c]=a[c])}}))};d.require=function(a,c){g("string"===typeof a?[a]:a,c)}})(this);_AP.define("_dollar",function(){return AJS.$});_AP.define("host/_util",function(){return{escapeSelector:function(e){if(!e)throw Error("No selector to escape");return e.replace(/[!"#$%&'()*+,.\/:;<=>?@[\\\]^`{|}~]/g,"\\$&")}}});
_AP.define("_rpc",["_dollar","_xdm"],function(e,g){var f=e.each,d=e.extend,b=e.isFunction,a={},c=[],k={},p=[];return{extend:function(h){b(h)&&(h=h());d(a,h.apis);d(k,h.internals);c=c.concat(h.stubs||[]);var e=h.init;b(e)&&p.push(e);return h.apis},init:function(b,l){b=b||{};f(a,function(a){c.push(a)});var m=new g(e,l,{remote:c,local:e.extend({},k)});f(p,function(a,c){try{c(d({},b),m)}catch(k){console.log(k)}})}}});
_AP.define("env",["_dollar","_rpc"],function(e,g){var f;g.extend(function(d){return{init:function(b){f=b},internals:{getLocation:function(){return window.location.href},getUser:function(){var b=AJS.Meta;(b=b?b.get("remote-user-fullname"):null)||(b=e("a#header-details-user-fullname, .user.ajs-menu-title, a#user").text());b||(b=e("a#user-menu-link").attr("title"));return{fullName:b,id:f.uid,key:f.ukey}},getTimeZone:function(){return f.data.timeZone}}}})});
_AP.define("resize",["_dollar","_rpc"],function(e,g){g.extend(function(){function f(d){var b=e(document).height()-e("#header > nav").outerHeight()-e("#footer").outerHeight()-20;e(d).css({width:"100%",height:b+"px"})}return{init:function(d,b){b.resize=_.debounce(function(a,c,b){a(this.iframe).css({width:c,height:b})})},internals:{resize:function(d,b){this.uiParams.isDialog||this.resize(e,d,b)},sizeToParent:_.debounce(function(){this.uiParams.isGeneral?(e(this.iframe).addClass("full-size-general-page"),
e(window).on("resize",function(){resizeHander(this.iframe)}),f(this.iframe)):e(this.iframe).addClass("full-size-general-page-fail")})}}})});
_AP.define("loading-indicator",["_dollar","_rpc","host/_status_helper"],function(e,g,f){g.extend(function(d){return{init:function(b,a){var c=e(a.iframe).closest(".ap-container");f.showLoadingStatus(c,0);a.timeout=setTimeout(function(){a.timeout=null;f.showloadTimeoutStatus(c);c.find(".ap-load-timeout").find("a.ap-btn-cancel").click(function(){f.showLoadErrorStatus(c);this.analytics.iframePerformance.timeout()})},2E4)},internals:{init:function(){this.analytics.iframePerformance.end();var b=e(this.iframe).closest(".ap-container");
f.showLoadedStatus(b);clearTimeout(this.timeout);b.find(".ap-content").addClass("iframe-init")}}}})});
_AP.define("request",["_dollar","_rpc"],function(e,g){var f=["status","statusText","responseText"],d=["Content-Type"];g.extend(function(){return{internals:{request:function(b,a,c){function k(a){var c={headers:{}};e.each(f,function(b,k){c[k]=a[k]});e.each(d,function(b,k){c.headers[k]=a.getResponseHeader(k)});return c}var p=AJS.contextPath()+b.url,h={};e.each(b.headers||{},function(a,c){h[a.toLowerCase()]=c});e.ajaxSettings={};e.ajax({url:p,type:b.type||"GET",data:b.data,dataType:"text",contentType:b.contentType,
headers:{Accept:h.accept||"*/*","AP-Client-Key":this.addonKey}}).then(function(c,b,d){a([c,b,k(d)])},function(a,b,d){c([k(a),b,d])})}}}})});
_AP.define("dialog",["_dollar","_rpc","dialog/dialog-factory","dialog/main"],function(e,g,f,d){g.extend(function(){return{stubs:["dialogMessage"],init:function(b,a){if(a.uiParams.isDialog){var c=d.getButton();c&&e.each(c,function(c,b){b.click(function(b,d){a.isActive()?a.dialogMessage(c,d):d(!0)})})}},internals:{setDialogButtonEnabled:function(b,a){d.getButton(b).setEnabled(a)},isDialogButtonEnabled:function(b,a){var c=d.getButton(b);a(c?c.isEnabled():void 0)},createDialog:function(b){var a={key:this.addonKey};
b.key?a.moduleKey=b.key:b.url&&(a.url=b.url);f(a,b,this.productContext)},closeDialog:function(b,a){this.events.emit("ra.iframe.destroy");d.close()}}}})});
_AP.define("history/rpc",["_dollar","history/history","_rpc"],function(e,g,f){f.extend(function(d){return{init:function(b,a){if(b.uiParams.isGeneral)e(window).on("hashchange",function(c){g.hashChange(c.originalEvent,a.historyMessage)})},internals:{historyPushState:function(b){if(this.uiParams.isGeneral)return g.pushState(b);e.log("History is only available to page modules")},historyReplaceState:function(b){if(this.uiParams.isGeneral)return g.replaceState(b);e.log("History is only available to page modules")},
historyGo:function(b){if(this.uiParams.isGeneral)return g.go(b);e.log("History is only available to page modules")}},stubs:["historyMessage"]}})});
(window.AP||window._AP).define("_events",["_dollar"],function(e){function g(a,c){this._key=a;this._origin=c;this._events={};this._any=[]}function f(a,c){for(var k=0;k<a.length;++k)try{a[k].apply(null,c)}catch(d){b(d.stack||d.message||d)}}var d=window,b=d.AJS&&d.AJS.log||d.console&&d.console.log||function(){},d=g.prototype;d.on=function(a,c){a&&c&&this._listeners(a).push(c);return this};d.once=function(a,c){var b=this,d=function(){b.off(a,d);c.apply(null,arguments)};this.on(a,d);return this};d.onAny=
function(a){this._any.push(a);return this};d.off=function(a,c){var b=this._events[a];if(b){var d=e.inArray(c,b);0<=d&&b.splice(d,1);0===b.length&&delete this._events[a]}return this};d.offAll=function(a){a?delete this._events[a]:this._events={};return this};d.offAny=function(a){var c=this._any;a=e.inArray(a,c);0<=a&&c.splice(a,1);return this};d.emit=function(a){return this._emitEvent(this._event.apply(this,arguments))};d._event=function(a){return{name:a,args:[].slice.call(arguments,1),attrs:{},source:{key:this._key,
origin:this._origin}}};d._emitEvent=function(a){var c=a.args.concat(a);f(this._listeners(a.name),c);f(this._any,[a.name].concat(c));return this};d._listeners=function(a){return this._events[a]=this._events[a]||[]};return{Events:g}});
(this.AP||this._AP).define("_uri",[],function(){function e(a){a&&(a=decodeURIComponent(a),a=a.replace(b.pluses," "));return a}function g(a){var c=b.uri_parser.exec(a||""),d={};"source protocol authority userInfo user password host port relative path directory file query anchor".split(" ").forEach(function(a,b){d[a]=c[b]||""});return d}function f(a){var c,d,e,h,f,g=[];if("undefined"===typeof a||null===a||""===a)return g;0===a.indexOf("?")&&(a=a.substring(1));c=a.toString().split(b.query_separator);
for(a=0;a<c.length;a++)d=c[a],e=d.indexOf("="),0!==e&&(h=decodeURIComponent(d.substring(0,e)),f=decodeURIComponent(d.substring(e+1).replace(/\+/g," ")),g.push(-1===e?[d,null]:[h,f]));return g}function d(a){this.uriParts=g(a);this.queryPairs=f(this.uriParts.query);this.hasAuthorityPrefixUserPref=null}var b={starts_with_slashes:/^\/+/,ends_with_slashes:/\/+$/,pluses:/\+/g,query_separator:/[&;]/,uri_parser:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/};
Array.prototype.forEach||(Array.prototype.forEach=function(a,c){for(var b=0,d=this.length;b<d;++b)a.call(c||this,this[b],b,this)});"protocol userInfo host port path anchor".split(" ").forEach(function(a){d.prototype[a]=function(c){"undefined"!==typeof c&&(this.uriParts[a]=c);return this.uriParts[a]}});d.prototype.hasAuthorityPrefix=function(a){"undefined"!==typeof a&&(this.hasAuthorityPrefixUserPref=a);return null===this.hasAuthorityPrefixUserPref?-1!==this.uriParts.source.indexOf("//"):this.hasAuthorityPrefixUserPref};
d.prototype.query=function(a){var c="",b;"undefined"!==typeof a&&(this.queryPairs=f(a));for(a=0;a<this.queryPairs.length;a++)b=this.queryPairs[a],0<c.length&&(c+="&"),null===b[1]?c+=b[0]:(c+=b[0],c+="=",b[1]&&(c+=encodeURIComponent(b[1])));return 0<c.length?"?"+c:c};d.prototype.getQueryParamValue=function(a){var c,b;for(b=0;b<this.queryPairs.length;b++)if(c=this.queryPairs[b],a===c[0])return c[1]};d.prototype.getQueryParamValues=function(a){var c=[],b,d;for(b=0;b<this.queryPairs.length;b++)d=this.queryPairs[b],
a===d[0]&&c.push(d[1]);return c};d.prototype.deleteQueryParam=function(a,c){var b=[],d,h,f,g;for(d=0;d<this.queryPairs.length;d++)h=this.queryPairs[d],f=e(h[0])===e(a),g=h[1]===c,(1!==arguments.length||f)&&(2!==arguments.length||f&&g)||b.push(h);this.queryPairs=b;return this};d.prototype.addQueryParam=function(a,b,d){3===arguments.length&&-1!==d?(d=Math.min(d,this.queryPairs.length),this.queryPairs.splice(d,0,[a,b])):0<arguments.length&&this.queryPairs.push([a,b]);return this};d.prototype.replaceQueryParam=
function(a,b,d){var f=-1,h,g;if(3===arguments.length){for(h=0;h<this.queryPairs.length;h++)if(g=this.queryPairs[h],e(g[0])===e(a)&&decodeURIComponent(g[1])===e(d)){f=h;break}this.deleteQueryParam(a,d).addQueryParam(a,b,f)}else{for(h=0;h<this.queryPairs.length;h++)if(g=this.queryPairs[h],e(g[0])===e(a)){f=h;break}this.deleteQueryParam(a);this.addQueryParam(a,b,f)}return this};"protocol hasAuthorityPrefix userInfo host port path query anchor".split(" ").forEach(function(a){var b="set"+a.charAt(0).toUpperCase()+
a.slice(1);d.prototype[b]=function(b){this[a](b);return this}});d.prototype.scheme=function(){var a="";this.protocol()?(a+=this.protocol(),this.protocol().indexOf(":")!==this.protocol().length-1&&(a+=":"),a+="//"):this.hasAuthorityPrefix()&&this.host()&&(a+="//");return a};d.prototype.origin=function(){var a=this.scheme();if("file://"==a)return a+this.uriParts.authority;this.userInfo()&&this.host()&&(a+=this.userInfo(),this.userInfo().indexOf("@")!==this.userInfo().length-1&&(a+="@"));this.host()&&
(a+=this.host(),this.port()&&(a+=":"+this.port()));return a};d.prototype.addTrailingSlash=function(){var a=this.path()||"";"/"!==a.substr(-1)&&this.path(a+"/");return this};d.prototype.toString=function(){var a,c=this.origin();this.path()?(a=this.path(),b.ends_with_slashes.test(c)||b.starts_with_slashes.test(a)?(c&&c.replace(b.ends_with_slashes,"/"),a=a.replace(b.starts_with_slashes,"/")):c+="/",c+=a):this.host()&&(this.query().toString()||this.anchor())&&(c+="/");this.query().toString()&&(0!==this.query().toString().indexOf("?")&&
(c+="?"),c+=this.query().toString());this.anchor()&&(0!==this.anchor().indexOf("#")&&(c+="#"),c+=this.anchor());return c};d.prototype.clone=function(){return new d(this.toString())};return{init:d}});
(window.AP||window._AP).define("host/_addons",["_dollar","_rpc"],function(e,g){var f={};g.extend(function(){var d={_emitEvent:function(b){e.each(f[b.source.key],function(a,c){c.bus._emitEvent(b)})},remove:function(b){var a=f[b.addonKey][b.id];a&&a.bus.offAny(a.listener);delete f[b.addonKey][b.id];return this},init:function(b,a){f[a.addonKey]||(f[a.addonKey]={});var c=f[a.addonKey][a.id]={bus:a.events,listener:function(){var b=arguments[arguments.length-1],c=b.trace=b.trace||{},e=a.id+"|addon";c[e]||
(c[e]=!0,d._emitEvent(b))}};c.bus.onAny(c.listener);c.bus.on("ra.iframe.destroy",function(){d.remove(a)})}};return d})});
_AP.define("host/main","_dollar _xdm host/_addons _rpc _ui-params analytics/analytics host/_util".split(" "),function(e,g,f,d,b,a,c){function k(a){if(!a)throw Error("ns undefined");return e("#embedded-"+c.escapeSelector(a))}function p(c){e.extend(c,b.fromUrl(c.src));var f=c.ns,h=k(f),g=h.attr("id"),p="channel-"+f,y=c.w||"100%",r=c.h||"0";(new Date).getTime();h.closest(".aui-inline-dialog");"object"!==typeof c.uiParams&&(c.uiParams={});c.general&&(c.uiParams.isGeneral=!0);c.dlg&&(c.uiParams.isDialog=
!0);h={remote:c.src,remoteKey:c.key,container:g,channel:p,props:{width:y,height:r},uiParams:c.uiParams};c.productCtx&&!c.productContext&&(c.productContext=JSON.parse(c.productCtx));d.extend({init:function(b,d){d.analytics=a.get(d.addonKey,f);d.analytics.iframePerformance.start();d.productContext=c.productContext}});d.init(c,h)}var h=window.requestAnimationFrame||function(a){setTimeout(a,10)};return function(a){function c(){0===k(a.ns).length&&10>b?setTimeout(function(){b++;c()},50):p(a)}$content=
k(a.ns);$contentIframe=$content.find("iframe");$contentIframe.length&&($contentIframe.trigger("ra.iframe.destroy"),$content.remove());var b=0;"undefined"!==typeof ConfluenceMobile?c():e.isReady?h(c):AJS.toInit(function(){if(AJS.Confluence&&AJS.Confluence.EditorLoader&&AJS.Confluence.EditorLoader.load)try{AJS.Confluence.EditorLoader.load(c,c)}catch(a){try{c()}catch(b){AJS.log(b)}}else try{c()}catch(d){AJS.log(d)}})}});_AP.create||_AP.require(["host/main"],function(e){_AP.create=e});
if("undefined"!==typeof ConfluenceMobile)ConfluenceMobile.contentEventAggregator.on("render:pre:after-content",function(e,g,f){window.eval.call(window,$(f.attributes.body).find(".ap-iframe-body-script").html())});
(window.AP||window._AP).define("_base64",["_dollar"],function(e){function g(){this.buffer=[]}function f(a){this._input=a;this._index=-1;this._buffer=[]}function d(a){this._input=a;this._index=-1;this._buffer=[]}g.prototype.append=function(a){this.buffer.push(a);return this};g.prototype.toString=function(){return this.buffer.join("")};var b={codex:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(a){var c=new g;for(a=new f(a);a.moveNext();){var b=a.current;a.moveNext();
var d=a.current;a.moveNext();var e=a.current,l=b>>2,b=(b&3)<<4|d>>4,m=(d&15)<<2|e>>6,u=e&63;isNaN(d)?m=u=64:isNaN(e)&&(u=64);c.append(this.codex.charAt(l)+this.codex.charAt(b)+this.codex.charAt(m)+this.codex.charAt(u))}return c.toString()},decode:function(a){var b=new g;for(a=new d(a);a.moveNext();){var e=a.current;if(128>e)b.append(String.fromCharCode(e));else if(191<e&&224>e){a.moveNext();var f=a.current;b.append(String.fromCharCode((e&31)<<6|f&63))}else a.moveNext(),f=a.current,a.moveNext(),b.append(String.fromCharCode((e&
15)<<12|(f&63)<<6|a.current&63))}return b.toString()}};f.prototype={current:Number.NaN,moveNext:function(){if(0<this._buffer.length)return this.current=this._buffer.shift(),!0;if(this._index>=this._input.length-1)return this.current=Number.NaN,!1;var a=this._input.charCodeAt(++this._index);13==a&&10==this._input.charCodeAt(this._index+1)&&(a=10,this._index+=2);128>a?this.current=a:(127<a&&2048>a?this.current=a>>6|192:(this.current=a>>12|224,this._buffer.push(a>>6&63|128)),this._buffer.push(a&63|128));
return!0}};d.prototype={current:64,moveNext:function(){if(0<this._buffer.length)return this.current=this._buffer.shift(),!0;if(this._index>=this._input.length-1)return this.current=64,!1;var a=b.codex.indexOf(this._input.charAt(++this._index)),c=b.codex.indexOf(this._input.charAt(++this._index)),d=b.codex.indexOf(this._input.charAt(++this._index)),e=b.codex.indexOf(this._input.charAt(++this._index)),f=(d&3)<<6|e;this.current=a<<2|c>>4;64!=d&&this._buffer.push((c&15)<<4|d>>2);64!=e&&this._buffer.push(f);
return!0}};return{encode:function(a){return window.btoa?window.btoa(a):b.encode(a)},decode:function(a){return window.atob?window.atob(a):b.decode(a)}}});
_AP.define("host/content",["_dollar","_uri","_ui-params"],function(e,g,f){function d(a,b){return AJS.contextPath()+"/plugins/servlet/ac/"+encodeURIComponent(a)+"/"+encodeURIComponent(b.key)}function b(a){a=a.attr("class").match(/ap-plugin-key-([^\s]*)/);return e.isArray(a)?a[1]:!1}return{getContentUrl:d,getIframeHtmlForUrl:function(a,b,d,g){var h=AJS.contextPath()+"/plugins/servlet/render-signed-iframe";return e.ajax(h,{dataType:"html",data:{dialog:!0,"ui-params":f.encode(g),"plugin-key":a,"product-context":JSON.stringify(d),
"remote-url":b,width:"100%",height:"100%",raw:"true"}})},getIframeHtmlForKey:function(a,b,g,p){var h=d(a,g);return e.ajax(h,{dataType:"html",data:{"ui-params":f.encode(p),"plugin-key":a,"product-context":JSON.stringify(b),key:g.key,width:"100%",height:"100%",raw:"true"}})},eventHandler:function(a,c,d){e(window.document).on(a,c,function(a){a.preventDefault();var f=e(a.target).closest(c),l=f.attr("href"),m=new g.init(l),f={bindTo:f,header:f.text(),width:m.getQueryParamValue("width"),height:m.getQueryParamValue("height"),
cp:m.getQueryParamValue("cp"),key:b(f)};d(l,f,a.type)})},getOptionsForWebItem:function(a){b(a);var c;c=a.attr("class").match(/ap-module-key-([^\s]*)/);c=e.isArray(c)?c[1]:!1;a=a.hasClass("ap-inline-dialog")?"inlineDialog":"dialog";return window._AP[a+"Options"][c]||{}}}});
_AP.define("analytics/analytics",["_dollar"],function(e){function g(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()}function f(a,c){var d={};this.addonKey=a;this.moduleKey=c;this.iframePerformance={start:function(){d.startLoading=g()},end:function(){var e=g()-d.startLoading;b.track("iframe.performance.load",{addonKey:a,moduleKey:c,value:2E4<e?"x":Math.ceil(e/100)});delete d.startLoading},timeout:function(){b.track("iframe.performance.timeout",{addonKey:a,
moduleKey:c});this.end()},cancel:function(){b.track("iframe.performance.cancel",{addonKey:a,moduleKey:c})}}}var d=["resize","init"],b=f.prototype;b.getKey=function(){return this.addonKey+":"+this.moduleKey};b.track=function(a,b){var d="connect.addon."+a;if(AJS.Analytics)AJS.Analytics.triggerPrivacyPolicySafeEvent(d,b);else if(AJS.trigger)AJS.trigger("analyticsEvent",{name:d,data:b});else return!1;return!0};b.trackBridgeMethod=function(a){if(-1!==e.inArray(a,d))return!1;this.track("bridge.invokemethod",
{name:a,addonKey:this.addonKey,moduleKey:this.moduleKey})};return{get:function(a,b){return new f(a,b)}}});
(this.AP||this._AP).define("_xdm","_events _base64 _uri _ui-params host/analytics host/_util".split(" "),function(e,g,f,d,b,a){function c(b,h,l){function m(a,b,c){try{v.postMessage(JSON.stringify({c:w,i:a,t:b,m:c}),t)}catch(d){B(d.message||d.toString())}}function u(a,b,c,d){var e=Math.floor(1E9*Math.random()).toString(16);E.add(e,c,d);m(e,"request",{n:a,a:b})}function G(a){try{var b=JSON.parse(a.data),c=b.i,d=b.c,e=b.t,f=b.m;a.source!==v&&a.origin.toLowerCase()===t&&d===w&&(v=a.source);if(a.source===
v&&a.origin.toLowerCase()===t&&d===w)if("request"===e){var g=f.n,h=f.a,k=C[g],l,p,q;if(k){l=function(a){m(c,"done",a)};p=function(a){m(c,"fail",a)};q=(h?h.length:0)<k.length;a=C;!0===n.isHost?(a=n,a.analytics&&a.analytics.trackBridgeMethod(g)):a.isHost=!1;try{q?k.apply(a,h.concat([l,p])):l(k.apply(a,h))}catch(r){p(r.message||r.toString())}}else A("Unhandled request:",b)}else if("done"===e||"fail"===e)E.invoke(e,c,f)||A("Unhandled response:",e,c,f)}catch(s){B(s.message||s.toString())}}function H(a){return function(){function c(){if(b.isFunction(d[d.length-
1]))return d.pop()}var d=[].slice.call(arguments),e,f;f=c();e=c();e||(e=f,f=void 0);u(a,d,e,f)}}function y(a){n.isActive()?G(a.originalEvent?a.originalEvent:a):b(window).unbind("message",y)}function r(a,b){return(new f.init(a)).getQueryParamValue(b)}function I(c){if(!c.container)throw Error("config.container must be defined");var e=document.createElement("iframe"),f="easyXDM_"+c.container+"_provider",g="";c.uiParams&&(g=d.encode(c.uiParams));b.extend(e,{id:f,name:g,frameBorder:"0"},c.props);e.setAttribute("rel",
"nofollow");b("#"+a.escapeSelector(c.container)).append(e);e.src=c.remote;return e}function A(){c.debug&&B.apply(x,["DEBUG:"].concat([].slice.call(arguments)))}function B(){var a=b.log||x.AJS&&x.AJS.log;a&&a.apply(x,arguments)}function J(a){if(null===a||""===a)throw"Invalid JWT: must be neither null nor empty-string.";var b=a.indexOf("."),c=a.indexOf(".",b+1);if(0>b||c<=b)throw'Invalid JWT: must contain 2 period (".") characters.';a=a.substring(b+1,c);if(null===a||""===a)throw"Invalid JWT: encoded claims must be neither null nor empty-string.";
a=g.decode(a);return JSON.parse(a)}var n,D,v,t,w,z,s,x=window,q=x.location.toString(),C=l.local||{};l=l.remote||[];var K=(new f.init(q)).origin(),E=function(){var a={};return{add:function(b,c,d){a[b]={done:c||null,fail:d||null,async:!!c}},invoke:function(b,c,d){var e;a[c]&&(a[c][b]?(a[c][b](d),e=!0):e=!a[c].async&&"fail"!==b,delete a[c]);return e}}}();/xdm_e/.test(q)?(v=x.parent,z="local",s=(h=r(q,"jwt"))?J(h).iss:r(q,"oauth_consumer_key"),null===s&&(s=Math.random()),s=z,t=r(q,"xdm_e").toLowerCase(),
w=r(q,"xdm_c"),h={isHost:!1,isActive:function(){return!0}}):(q=I(h),v=q.contentWindow,z=r(h.remote,"oauth_consumer_key")||r(h.remote,"jwt"),s=h.remoteKey,t=(new f.init(h.remote)).origin().toLowerCase(),w=h.channel,h={isHost:!0,iframe:q,uiParams:h.uiParams,destroy:function(){b(window).unbind("message",y);n.iframe&&(b(n.iframe).remove(),delete n.iframe)},isActive:function(){return b.contains(document.documentElement,n.iframe)}},b(q).on("ra.iframe.destroy",h.destroy));D=s+"|"+(k+=1);n=b.extend({id:D,
remoteOrigin:t,channel:w,addonKey:s},h);b.each(l,function(a,b){"number"===typeof a&&(a=b);n[a]=H(a)});var F=n.events=new e.Events(z,K);F.onAny(function(){var a=arguments[arguments.length-1],c=a.trace=a.trace||{},d=n.id+"|xdm";if(n.isHost&&!c[d]&&a.source.channel!==n.id||!n.isHost&&a.source.key===z)c[d]=!0,a=b.extend({},a),delete a.trace,A("Forwarding "+(n.isHost?"host":"addon")+" event:",a),u("_event",[a])});C._event=function(a){delete a.trace;this.isHost&&(a.source={channel:this.id||D,key:this.addonKey,
origin:this.remoteOrigin||t});A("Receiving as "+(this.isHost?"host":"addon")+" event:",a);F._emitEvent(a)};b(window).bind("message",y);return n}var k=0;return c});
(this.AP||this._AP).define("_ui-params",["_dollar","_base64","_uri"],function(e,g,f){return{encode:function(d){return g.encode(JSON.stringify(d))},fromUrl:function(d){d=new f.init(d);d=d.getQueryParamValue("ui-params");return this.decode(d)},fromWindowName:function(d,b){d=d||window;var a=this.decode(d.name);return b?a?a[b]:void 0:a},decode:function(d){var b={};if(d&&0<d.length)try{b=JSON.parse(g.decode(d))}catch(a){console&&console.log&&console.log("Cannot decode passed ui params",d)}return b}}});
_AP.define("host/_status_helper",["_dollar"],function(e){function g(b){b.data("loadingStatusTimer")&&(clearTimeout(b.data("loadingStatusTimer")),b.removeData("loadingStatusTimer"));b.find(".ap-status").addClass("hidden")}function f(b,a){g(b);b.closest(".ap-container").removeClass("hidden");b.find(".ap-stats").removeClass("hidden");b.find(".ap-"+a).removeClass("hidden");setTimeout(function(){var b=AJS.$(".small-spinner",".ap-"+a);b.length&&b.spin({zIndex:"1"})},10)}var d={loading:{descriptionHtml:'<div class="small-spinner"></div>Loading add-on...'},
"load-timeout":{descriptionHtml:'<div class="small-spinner"></div>Add-on is not responding. Wait or <a href="#" class="ap-btn-cancel">cancel</a>?'},"load-error":{descriptionHtml:"Add-on failed to load."}};return{createStatusMessages:function(){var b,a=e('<div class="ap-stats" />');for(b in d){var c=e('<div class="ap-'+b+' ap-status hidden" />');c.append("<small>"+d[b].descriptionHtml+"</small>");a.append(c)}return a},showLoadingStatus:function(b,a){if(a){var c=setTimeout(f.bind(null,b,"loading"),
a);b.data("loadingStatusTimer",c)}else f(b,"loading")},showloadTimeoutStatus:function(b){f(b,"load-timeout")},showLoadErrorStatus:function(b){f(b,"load-error")},showLoadedStatus:function(b){g(b)}}});
